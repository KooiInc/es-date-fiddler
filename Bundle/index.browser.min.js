window.$D=window.DateX=C();window.DateXFactory=C;function C(){let a=k(l),S={get:(n,o)=>n[o]?D(n,o):a[o]?.(n),set:(n,o,f)=>a[o]?a[o](n,f):n[o],ownKeys:n=>Object.getOwnPropertyNames(a),has:(n,o)=>o in a||o in n};function l(n){return new Proxy(n,S)}function D(n,o){return o in n&&n[o]instanceof Function?n[o].bind(n):n[o]}function u(n,o){let f=n?.locale||n?.timeZone,g=(n||"")instanceof Date,s=f?new Date:new Date(g?n:Date.parse(n)),m=isNaN(s)?new Date(Date.now()):s,c=l(m);return(f||o)&&(c.locale=f?n:o),c}return u.extendWith=function({name:n,fn:o,isMethod:f=!1,proxifyResult:g=!1}={}){if(!n||!o||!(o instanceof Function))return console.error("es-date-fiddler (extendWith): cannot extend without name and/or fn (function)");a[n]=s=>(s=l(s),s.localeInfo&&s.relocate(s.localeInfo),f?(...m)=>g?l(o(s,...m)):o(s,...m):g?l(o(s)):o(s))},u}function k(a){let S=_(),l=e=>!(isNaN(parseInt(e))&&isNaN(+e)),D=e=>e?.constructor===Object,u=e=>+e.slice(e.indexOf("+")+1).replace(":","")||0,n=e=>e.localeInfo?.timeZone||Intl.DateTimeFormat().resolvedOptions().timeZone,o=(e,t=2)=>`${e}`.padStart(t,"0"),f=e=>e.map(t=>String(t)?.padStart(2,"0")??t),g=e=>f(T(e)).join("-"),s=e=>Object.entries(e).filter(([,t])=>l(t)),m=(e,t)=>{let r={year:e.getFullYear(),month:e.getMonth()+1,date:e.getDate(),hour:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds(),milliseconds:e.getMilliseconds()};return t?Object.values(r):r},c=(e,{locale:t,timeZone:r}={})=>((t||r)&&(e.localeInfo=U(e,{locale:t,timeZone:r})),e.localeInfo),i=e=>{let t=e.localeInfo||{timeZone:getTimeZone};return a(new Date(new Date(e.toLocaleString("en",t)).toLocaleString("en-CA",{hourCycle:"h23"}))).relocate(t)},h=(e,t)=>{t=a(t??new Date);let r=a(e);if(t){let{year:y,month:M,date:w}=r;t.date={year:y,month:M,date:w},r.locale&&(t.locale={locale:r.locale.locale,timeZone:r.locale.timeZone})}return t},p=(e,t)=>{t=a(t??new Date);let r=a(e),{hour:y,minutes:M,seconds:w,ms:Z}=r;return t.time={hour:y,minutes:M,seconds:w,ms:Z},r.locale&&(t.locale={locale:r.locale.locale,timeZone:r.locale.timeZone}),t},d=function(e){let r=Y(e)?.replace(/l:/,"locale: ").replace(/tz:/,"timeZone: ");return e.toLocaleString()+` !!invalid locale info => ${r}`},N=e=>{e=a(e);let t={};if(!e.locale)return e.toLocaleString();e.locale?.timeZone&&(t={timeZone:e.locale.timeZone});try{return e.toLocaleString(e.locale?.locale,t)}catch{return d(e)}},I=(e,...t)=>{e=a(e);let[r,y]=[e.locale,e.timeZone],M=Y(e);try{return t.length===1?S(e,t[0],M):t.length?S(e,...t):e.toLocaleString(r,y?{timeZone:y}:void 0)}catch{return d(a(e))}},$=(e,t)=>D(t)&&s(t).forEach(([r,y])=>e[`set${r}`](y))&&!0||!1,b=e=>[e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()??0],T=e=>[e.getFullYear(),e.getMonth()+1,e.getDate()],z=(e,t)=>{let r=b(e).reduce((y,M,w)=>[...y,w<3?o(M):o(M,3)],[]);return`${r.slice(0,3).join(":")}${t?`.${r.slice(-1)}`:""}`},A=(e,t)=>$(e,t)||b(e),L=(e,t)=>$(e,t)||T(e),W=q(),O=(e,t)=>a(new Date(e,t+1,1,0,0,0)).yesterday.getDate(),K=e=>[e.getFullYear(),e.getMonth(),e.getDate()],H=e=>a(new Date(e)),P=G(),F=(e,...t)=>a(P(e,...t)),U=function(e,{locale:t,timeZone:r}={}){[t,r]=[t||e.localeInfo?.locale,r||e.localeInfo?.timeZone];let y=[`${t?`l:${t}`:""}`,`${r?`tz:${r}`:""}`].filter(M=>M).join(", ");return e.localeInfo={formats:y,...t?{locale:t}:{},...r?{timeZone:r}:{}},e.localeInfo},Y=e=>{e=a(e);let[t,r]=[e.localeInfo?.locale,e.localeInfo?.timeZone];return[`${t?`l:${t}`:""}`,`${r?`tz:${r}`:""}`].filter(y=>y).join(", ")},x=e=>{e=a(e),delete e.localeInfo},E=function(e,t,r){return e=a(e),e.locale={locale:t,timeZone:r},e},j=function(e,t){return e=a(e),e.format(t?"MM":"WD",`l:${e.locale?.locale||"utc"}`)},X=e=>{try{return new Intl.DateTimeFormat(e.localeInfo.locale||"en",{year:"numeric",month:"2-digit",day:"2-digit",timeZone:e.localeInfo.timeZone||"utc"}).format(e)}catch{return g(e)}};return{clone:H,localizedDT:i,hasDST:e=>{let t=n(e),r=new Date(e.getFullYear(),0,1,14),y=new Date(new Date(r).setMonth(6)),M=Intl.DateTimeFormat("en-CA",{year:"numeric",timeZone:t,timeZoneName:"shortOffset"}),[w,Z]=[M.format(r),M.format(y)];return u(w)-u(Z)!==0},getTimezone:n,year:(e,t)=>t&&e.setFullYear(t)||e.getFullYear(),month:(e,t)=>t&&e.setMonth(v-1)||e.getMonth()+1,date:(e,{year:t,month:r,date:y}={})=>L(e,{FullYear:t,Month:l(r)?r-1:r,Date:y}),hour:(e,t)=>t&&e.setHours(t)||e.getHours(),minutes:(e,t)=>t&&e.setMinutes(t)||e.getMinutes(),seconds:(e,t)=>t&&e.setSeconds(t)||e.getSeconds(),cloneTimeTo:e=>t=>p(e,t),cloneDateTo:e=>t=>h(e,t),time:(e,{hour:t,minutes:r,seconds:y,milliseconds:M}={})=>A(e,{Hours:t,Minutes:r,Seconds:y,Milliseconds:M}),timeStr:e=>(t=!1)=>z(e,t),dateStr:e=>e.localeInfo&&X(e)||g(e),ms:(e,t)=>t&&e.setMilliseconds(t)||e.getMilliseconds(),monthName:e=>j(e,!0),weekDay:e=>j(e),self:e=>e,local:e=>N(e),locale:(e,{locale:t,timeZone:r}={})=>c(e,{locale:t,timeZone:r}),removeLocale:e=>()=>x(e),relocate:e=>({locale:t,timeZone:r}={})=>E(e,t,r),differenceFrom:e=>t=>W({start:e,end:t}),values:e=>t=>m(e,t),ISO:e=>e.toISOString(),daysInMonth:e=>O(e.getFullYear(),e.getMonth()),isLeapYear:e=>O(e.getFullYear(),1)===29,format:e=>(...t)=>I(e,...t),addYears:e=>(t=1)=>F(e,`${t} years`),addMonths:e=>(t=1)=>F(e,`${t} months`),addWeeks:e=>(t=1)=>F(e,`${t*7} days`),addDays:e=>(t=1)=>F(e,`${t} days`),nextYear:e=>F(e,"1 year"),nextWeek:e=>F(e,"7 days"),previousWeek:e=>F(e,"subtract, 7 days"),previousYear:e=>F(e,"subtract, 1 year"),nextMonth:e=>F(e,"1 month"),previousMonth:e=>F(e,"subtract, 1 month"),tomorrow:e=>F(e,"1 day"),yesterday:e=>F(e,"subtract, 1 day"),add:e=>(...t)=>F(e,...t),subtract:e=>(...t)=>F(e,...["subtract"].concat([t]).flat())}}function _(){let[a,S,l,D]=["2-digit","numeric","long","short"],u={fixed:{MM:{month:l},M:{month:D},m:{month:S},mm:{month:a},yyyy:{year:S},yy:{year:a},WD:{weekday:l},wd:{weekday:D},d:{day:S},dd:{day:a},h:{hour:S},hh:{hour:a},mi:{minute:S},mmi:{minute:a},s:{second:S},ss:{second:a},ms:{fractionalSecondDigits:3},tz:{timeZoneName:"shortOffset"},dl:{locale:"default"},h12:{hour12:!1},yn:{yearName:""},ry:{relatedYear:!0},msp:{fractionalSecond:!0}},dynamic:{tzn:c=>({timeZoneName:c.slice(4)}),hrc:c=>({hourCycle:`h${c.slice(4)}`}),ds:c=>({dateStyle:c.slice(3)}),ts:c=>({timeStyle:c.slice(3)}),tz:c=>({timeZone:c.slice(3)}),e:c=>({era:c.slice(2)}),l:c=>({locale:c.slice(2)})}},n={...u,retrieveDyn(c){let i=c?.slice(0,c.indexOf(":"));return u.dynamic[i]&&u.dynamic[i](c)},get re(){return new RegExp(`\\b(${Object.keys(u.fixed).join("|")})\\b`,"g")}},o=(c="dtf",i=0)=>{let h=` ${c.replace(/(?<=\{)(.+?)(?=})/g,d=>`[${i++}]`).replace(/[{}]/g,"").trim()} `,p=c.match(/(?<=\{)(.+?)(?=})/g)||[];return{get texts(){return p},formatString(d){h=d},set formatStr(d){h=d},get formatStr(){return h},get units(){return h.match(n.re)||[]},finalize(d="",N="",I="",$=""){return h.replace(/~([\d+]?)/g,"$1").replace(/dtf/,d).replace(/era/,I).replace(/dp\b|~dp\b/,N).replace(/yn\b/,$).replace(/\[(\d+?)]/g,(b,T)=>p[T].trim()).trim()}}},f=c=>c.replace(/\s+/g,""),g=(...c)=>c?.reduce((i,h)=>({...i,...n.retrieveDyn(h)||n.fixed[h]}),n.fixed.dl),s=(c,i,h)=>{let p=g(...f(h).split(",")),d=Intl.DateTimeFormat(p.locale,p).format(c);return i.finalize(d)},m=(c,i,h)=>{let p=g(...i.units.concat(f(h).split(",")).flat()),d={...n.fixed},N=($,b)=>p[$]==="numeric"&&b.startsWith("0")?b.slice(1):b,I=Intl.DateTimeFormat(p.locale,p).formatToParts(c).reduce(($,b)=>b.type==="literal"?$:{...$,[b.type]:N(b.type,b.value)},{});return d.ms=p.fractionalSecondDigits?d.msp:d.ms,d.yyyy=I.relatedYear?d.ry:d.yyyy,i.formatStr=i.formatStr.replace(n.re,$=>I[Object.keys(d[$]).shift()]||$),i.finalize(void 0,I.dayPeriod,I.era,I.yearName)};return(c,i,h="l:default")=>/ds:|ts:/.test(h)?s(c,o(void 0),h):m(c,o(i||void 0),h)}function q(){let a=(D,u)=>{let n=isNaN(D),o=isNaN(u);if(n&&!o){let[f,g,s]=Array(3).fill("start- and/or end date are not valid");return{error:!0,message:f,full:g,clean:s}}if(o){let[f,g,s]=Array(3).fill("end date not valid");return{error:!0,message:f,full:g,clean:s}}if(n){let[f,g,s]=Array(3).fill("start date not valid");return{error:!0,message:f,full:g,clean:s}}return{error:!1}},S=l();return function({start:u,end:n}={}){let o=new Date(Date.parse(u)),f=new Date(Date.parse(n)),g=a(o,f);if(g.error)return g;let s=new Date(u),m=new Date(n),c=Math.abs(m-s),i=new Date(c),h=i.getUTCFullYear()-1970,p=i.getUTCMonth(),d=i.getUTCDate()-1,N=i.getUTCHours(),I=i.getUTCMinutes(),$=i.getUTCSeconds(),b=i.getUTCMilliseconds(),T={from:s,to:m,years:h,months:p,days:d,hours:N,minutes:I,seconds:$,milliseconds:b};return T.full=S({values:T,full:!0}),T.clean=S({values:T}),T};function l(){let D=(...s)=>m=>s.reduce((c,i)=>i(c),m),u=(s,m)=>s===1?m.slice(0,-1):m;return D(({values:s,full:m})=>[Object.entries(s).filter(([c])=>/^(years|month|days|hours|minutes|seconds)/i.test(c)),m],([s,m])=>m?s:s.filter(([,c])=>m?+c:c>0),s=>s.reduce((m,[c,i])=>[...m,`${i} ${u(i,c)}`],[]),s=>s.length<1?"Dates are equal":`${s.slice(0,-1).join(", ")}${s.length>1?" and ":""}${s.slice(-1).shift()}`)}}function G(){let a=Object.entries({year:"FullYear",month:"Month",date:"Date",day:"Date",hour:"Hours",minute:"Minutes",second:"Seconds",millisecond:"Milliseconds"}).reduce((l,[D,u])=>({...l,[D]:u,[`${D}s`]:u}),{}),S=function(...l){if(l.length<1)return[];let D;l[0].startsWith("subtract")&&(D=!0,l[0].startsWith("subtract")&&l.length===1&&(l=l[0].split(",")),l=l.slice(1));let u=l.length===1?l[0]?.split(/,/):l;return u&&u.length&&(l=u.map(n=>n.trim())),l.map(function(n){return n.toLowerCase().split(/\s/).map(o=>(o=o.trim(),+o?D?-o:+o:o))})};return function(l,...D){let u=S(...D);return u.length&&u.forEach(([n,o])=>{o=a[o],+n&&o&&l[`set${o}`](l[`get${o}`]()+ +n)}),l}}
