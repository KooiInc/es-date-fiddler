var E=DateX=Z();module.exports={DateX,$D:E,DateXFactory:Z};function Z(){let l=k(a),S={get:(n,o)=>!n[o]&&l[o]?.(n)||h(n,o),set:(n,o,m)=>l[o]?.(n,m)||n[o],ownKeys:n=>Object.getOwnPropertyNames(l),has:(n,o)=>o in l||o in n};function a(n){return new Proxy(n,S)}function h(n,o){return o in n&&n[o]instanceof Function?n[o].bind(n):n[o]}function u(n,o){let m=n?.locale||n?.timeZone,y=(n||"")instanceof Date,s=m?new Date:new Date(y?n:Date.parse(n)),f=isNaN(s)?new Date(Date.now()):s,r=a(f);return(m||o)&&(r.locale=m?n:o),r}return u.extendWith=function({name:n,fn:o,isMethod:m=!1,proxifyResult:y=!1}={}){if(!n||!o||!(o instanceof Function))return console.error("es-date-fiddler (extendWith): cannot extend without name and/or fn (function)");l[n]=s=>(s=a(s),s.localeInfo&&s.relocate(s.localeInfo),m?(...f)=>y?a(o(s,...f)):o(s,...f):y?a(o(s)):o(s))},u}function k(l){let S=X(),a=e=>!(isNaN(parseInt(e))&&isNaN(+e)),h=e=>e?.constructor===Object,u=(e,t=2)=>`${e}`.padStart(t,"0"),n=e=>e.map(t=>String(t)?.padStart(2,"0")??t),o=e=>n(M(e)).join("-"),m=e=>Object.entries(e).filter(([,t])=>a(t)),y=(e,t)=>{let c={year:e.getFullYear(),month:e.getMonth()+1,date:e.getDate(),hour:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds(),milliseconds:e.getMilliseconds()};return t?Object.values(c):c},s=(e,{locale:t,timeZone:c}={})=>((t||c)&&(e.localeInfo=A(e,{locale:t,timeZone:c})),e.localeInfo),f=e=>t=>new Date(new Date().toLocaleString("en",{timeZone:t})).toLocaleString("en-CA",{hourCycle:"h23"}),r=(e,t)=>{t=l(t??new Date);let c=l(e);if(t){let{year:D,month:I,date:j}=c;t.date={year:D,month:I,date:j},c.locale&&(t.locale={locale:c.locale.locale,timeZone:c.locale.timeZone})}return t},i=(e,t)=>{t=l(t??new Date);let c=l(e),{hour:D,minutes:I,seconds:j,ms:U}=c;return t.time={hour:D,minutes:I,seconds:j,ms:U},c.locale&&(t.locale={locale:c.locale.locale,timeZone:c.locale.timeZone}),t},d=function(e){let c=Y(e)?.replace(/l:/,"locale: ").replace(/tz:/,"timeZone: ");return e.toLocaleString()+` !!invalid locale info => ${c}`},p=e=>{e=l(e);let t={};if(!e.locale)return e.toLocaleString();e.locale?.timeZone&&(t={timeZone:e.locale.timeZone});try{return e.toLocaleString(e.locale?.locale,t)}catch{return d(e)}},g=(e,...t)=>{e=l(e);let[c,D]=[e.locale,e.timeZone],I=Y(e);try{return t.length===1?S(e,t[0],I):t.length?S(e,...t):e.toLocaleString(c,D?{timeZone:D}:void 0)}catch{return d(l(e))}},T=(e,t)=>h(t)&&m(t).forEach(([c,D])=>e[`set${c}`](D))&&!0||!1,F=e=>[e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()??0],M=e=>[e.getFullYear(),e.getMonth()+1,e.getDate()],b=(e,t)=>{let c=F(e).reduce((D,I,j)=>[...D,j<3?u(I):u(I,3)],[]);return`${c.slice(0,3).join(":")}${t?`.${c.slice(-1)}`:""}`},N=(e,t)=>T(e,t)||F(e),w=(e,t)=>T(e,t)||M(e),L=_(),O=(e,t)=>l(new Date(e,t+1,1,0,0,0)).yesterday.getDate(),G=e=>[e.getFullYear(),e.getMonth(),e.getDate()],z=e=>l(new Date(e)),W=q(),$=(e,...t)=>l(W(e,...t)),A=function(e,{locale:t,timeZone:c}={}){[t,c]=[t||e.localeInfo?.locale,c||e.localeInfo?.timeZone];let D=[`${t?`l:${t}`:""}`,`${c?`tz:${c}`:""}`].filter(I=>I).join(", ");return e.localeInfo={formats:D,...t?{locale:t}:{},...c?{timeZone:c}:{}},e.localeInfo},Y=e=>{e=l(e);let[t,c]=[e.localeInfo?.locale,e.localeInfo?.timeZone];return[`${t?`l:${t}`:""}`,`${c?`tz:${c}`:""}`].filter(D=>D).join(", ")},H=e=>{e=l(e),delete e.localeInfo},P=function(e,t,c){return e=l(e),e.locale={locale:t,timeZone:c},e},C=function(e,t){return e=l(e),e.format(t?"MM":"WD",`l:${e.locale?.locale||"utc"}`)},x=e=>{try{return new Intl.DateTimeFormat(e.localeInfo.locale||"en",{year:"numeric",month:"2-digit",day:"2-digit",timeZone:e.localeInfo.timeZone||"utc"}).format(e)}catch{return o(e)}};return{clone:z,currentLocalTime4TZ:f,year:(e,t)=>t&&e.setFullYear(t)||e.getFullYear(),month:(e,t)=>t&&e.setMonth(v-1)||e.getMonth()+1,date:(e,{year:t,month:c,date:D}={})=>w(e,{FullYear:t,Month:a(c)?c-1:c,Date:D}),hour:(e,t)=>t&&e.setHours(t)||e.getHours(),minutes:(e,t)=>t&&e.setMinutes(t)||e.getMinutes(),seconds:(e,t)=>t&&e.setSeconds(t)||e.getSeconds(),cloneTimeTo:e=>t=>i(e,t),cloneDateTo:e=>t=>r(e,t),time:(e,{hour:t,minutes:c,seconds:D,milliseconds:I}={})=>N(e,{Hours:t,Minutes:c,Seconds:D,Milliseconds:I}),timeStr:e=>(t=!1)=>b(e,t),dateStr:e=>e.localeInfo&&x(e)||o(e),ms:(e,t)=>t&&e.setMilliseconds(t)||e.getMilliseconds(),monthName:e=>C(e,!0),weekDay:e=>C(e),self:e=>e,local:e=>p(e),locale:(e,{locale:t,timeZone:c}={})=>s(e,{locale:t,timeZone:c}),removeLocale:e=>()=>H(e),relocate:e=>({locale:t,timeZone:c}={})=>P(e,t,c),differenceFrom:e=>t=>L({start:e,end:t}),values:e=>t=>y(e,t),ISO:e=>e.toISOString(),daysInMonth:e=>O(e.getFullYear(),e.getMonth()),isLeapYear:e=>O(e.getFullYear(),1)===29,format:e=>(...t)=>g(e,...t),addYears:e=>(t=1)=>$(e,`${t} years`),addMonths:e=>(t=1)=>$(e,`${t} months`),addWeeks:e=>(t=1)=>$(e,`${t*7} days`),addDays:e=>(t=1)=>$(e,`${t} days`),nextYear:e=>$(e,"1 year"),nextWeek:e=>$(e,"7 days"),previousWeek:e=>$(e,"subtract, 7 days"),previousYear:e=>$(e,"subtract, 1 year"),nextMonth:e=>$(e,"1 month"),previousMonth:e=>$(e,"subtract, 1 month"),tomorrow:e=>$(e,"1 day"),yesterday:e=>$(e,"subtract, 1 day"),add:e=>(...t)=>$(e,...t),subtract:e=>(...t)=>$(e,...["subtract"].concat([t]).flat())}}function X(){let[l,S,a,h]=["2-digit","numeric","long","short"],u={fixed:{MM:{month:a},M:{month:h},m:{month:S},mm:{month:l},yyyy:{year:S},yy:{year:l},WD:{weekday:a},wd:{weekday:h},d:{day:S},dd:{day:l},h:{hour:S},hh:{hour:l},mi:{minute:S},mmi:{minute:l},s:{second:S},ss:{second:l},ms:{fractionalSecondDigits:3},tz:{timeZoneName:"shortOffset"},dl:{locale:"default"},h12:{hour12:!1},yn:{yearName:""},ry:{relatedYear:!0},msp:{fractionalSecond:!0}},dynamic:{tzn:r=>({timeZoneName:r.slice(4)}),hrc:r=>({hourCycle:`h${r.slice(4)}`}),ds:r=>({dateStyle:r.slice(3)}),ts:r=>({timeStyle:r.slice(3)}),tz:r=>({timeZone:r.slice(3)}),e:r=>({era:r.slice(2)}),l:r=>({locale:r.slice(2)})}},n={...u,retrieveDyn(r){let i=r?.slice(0,r.indexOf(":"));return u.dynamic[i]&&u.dynamic[i](r)},get re(){return new RegExp(`\\b(${Object.keys(u.fixed).join("|")})\\b`,"g")}},o=(r="dtf",i=0)=>{let d=` ${r.replace(/(?<=\{)(.+?)(?=})/g,g=>`[${i++}]`).replace(/[{}]/g,"").trim()} `,p=r.match(/(?<=\{)(.+?)(?=})/g)||[];return{get texts(){return p},formatString(g){d=g},set formatStr(g){d=g},get formatStr(){return d},get units(){return d.match(n.re)||[]},finalize(g="",T="",F="",M=""){return d.replace(/~([\d+]?)/g,"$1").replace(/dtf/,g).replace(/era/,F).replace(/dp\b|~dp\b/,T).replace(/yn\b/,M).replace(/\[(\d+?)]/g,(b,N)=>p[N].trim()).trim()}}},m=r=>r.replace(/\s+/g,""),y=(...r)=>r?.reduce((i,d)=>({...i,...n.retrieveDyn(d)||n.fixed[d]}),n.fixed.dl),s=(r,i,d)=>{let p=y(...m(d).split(",")),g=Intl.DateTimeFormat(p.locale,p).format(r);return i.finalize(g)},f=(r,i,d)=>{let p=y(...i.units.concat(m(d).split(",")).flat()),g={...n.fixed},T=(M,b)=>p[M]==="numeric"&&b.startsWith("0")?b.slice(1):b,F=Intl.DateTimeFormat(p.locale,p).formatToParts(r).reduce((M,b)=>b.type==="literal"?M:{...M,[b.type]:T(b.type,b.value)},{});return g.ms=p.fractionalSecondDigits?g.msp:g.ms,g.yyyy=F.relatedYear?g.ry:g.yyyy,i.formatStr=i.formatStr.replace(n.re,M=>F[Object.keys(g[M]).shift()]||M),i.finalize(void 0,F.dayPeriod,F.era,F.yearName)};return(r,i,d="l:default")=>/ds:|ts:/.test(d)?s(r,o(void 0),d):f(r,o(i||void 0),d)}function _(){let l=(h,u)=>{let n=isNaN(h),o=isNaN(u);if(n&&!o){let[m,y,s]=Array(3).fill("start- and/or end date are not valid");return{error:!0,message:m,full:y,clean:s}}if(o){let[m,y,s]=Array(3).fill("end date not valid");return{error:!0,message:m,full:y,clean:s}}if(n){let[m,y,s]=Array(3).fill("start date not valid");return{error:!0,message:m,full:y,clean:s}}return{error:!1}},S=a();return function({start:u,end:n}={}){let o=new Date(Date.parse(u)),m=new Date(Date.parse(n)),y=l(o,m);if(y.error)return y;let s=new Date(u),f=new Date(n),r=Math.abs(f-s),i=new Date(r),d=i.getUTCFullYear()-1970,p=i.getUTCMonth(),g=i.getUTCDate()-1,T=i.getUTCHours(),F=i.getUTCMinutes(),M=i.getUTCSeconds(),b=i.getUTCMilliseconds(),N={from:s,to:f,years:d,months:p,days:g,hours:T,minutes:F,seconds:M,milliseconds:b};return N.full=S({values:N,full:!0}),N.clean=S({values:N}),N};function a(){let h=(...s)=>f=>s.reduce((r,i)=>i(r),f),u=(s,f)=>s===1?f.slice(0,-1):f;return h(({values:s,full:f})=>[Object.entries(s).filter(([r])=>/^(years|month|days|hours|minutes|seconds)/i.test(r)),f],([s,f])=>f?s:s.filter(([,r])=>f?+r:r>0),s=>s.reduce((f,[r,i])=>[...f,`${i} ${u(i,r)}`],[]),s=>s.length<1?"Dates are equal":`${s.slice(0,-1).join(", ")}${s.length>1?" and ":""}${s.slice(-1).shift()}`)}}function q(){let l=Object.entries({year:"FullYear",month:"Month",date:"Date",day:"Date",hour:"Hours",minute:"Minutes",second:"Seconds",millisecond:"Milliseconds"}).reduce((a,[h,u])=>({...a,[h]:u,[`${h}s`]:u}),{}),S=function(...a){if(a.length<1)return[];let h;a[0].startsWith("subtract")&&(h=!0,a[0].startsWith("subtract")&&a.length===1&&(a=a[0].split(",")),a=a.slice(1));let u=a.length===1?a[0]?.split(/,/):a;return u&&u.length&&(a=u.map(n=>n.trim())),a.map(function(n){return n.toLowerCase().split(/\s/).map(o=>(o=o.trim(),+o?h?-o:+o:o))})};return function(a,...h){let u=S(...h);return u.length&&u.forEach(([n,o])=>{o=l[o],+n&&o&&a[`set${o}`](a[`get${o}`]()+ +n)}),a}}
