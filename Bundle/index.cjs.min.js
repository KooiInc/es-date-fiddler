exports.DateFiddlerFactory=x;function x(){let f=j(b),h={get:(s,o)=>!s[o]&&f[o]?.(s)||r(s,o),set:(s,o,d)=>f[o]?.(s,d)||s[o]};return function(s){let o=new Date(Date.parse(s)),d=isNaN(o)?new Date(Date.now()):o;return b(d)};function b(s){return new Proxy(s,h)}function r(s,o){return o in s&&s[o]instanceof Function?s[o].bind(s):s[o]}}function U(){let[f,h,b,r]=["2-digit","numeric","long","short"],s={fixed:{MM:{month:b},M:{month:r},m:{month:h},mm:{month:f},yyyy:{year:h},yy:{year:f},WD:{weekday:b},wd:{weekday:r},d:{day:h},dd:{day:f},h:{hour:h},hh:{hour:f},mi:{minute:h},mmi:{minute:f},s:{second:h},ss:{second:f},ms:{fractionalSecondDigits:3},tz:{timeZoneName:"shortOffset"},dl:{locale:"default"},h12:{hour12:!1},yn:{yearName:""},ry:{relatedYear:!0},msp:{fractionalSecond:!0}},dynamic:{tzn:n=>({timeZoneName:n.slice(4)}),hrc:n=>({hourCycle:`h${n.slice(4)}`}),ds:n=>({dateStyle:n.slice(3)}),ts:n=>({timeStyle:n.slice(3)}),tz:n=>({timeZone:n.slice(3)}),e:n=>({era:n.slice(2)}),l:n=>({locale:n.slice(2)})}},o={...s,retrieveDyn(n){let a=n?.slice(0,n.indexOf(":"));return s.dynamic[a]&&s.dynamic[a](n)},get re(){return new RegExp(`\\b(${Object.keys(s.fixed).join("|")})\\b`,"g")}},d=(n="dtf",a=0)=>{let m=` ${n.replace(/(?<=\{)(.+?)(?=})/g,u=>`[${a++}]`).replace(/[{}]/g,"").trim()} `,D=n.match(/(?<=\{)(.+?)(?=})/g)||[];return{get texts(){return D},formatString(u){m=u},set formatStr(u){m=u},get formatStr(){return m},get units(){return m.match(o.re)||[]},finalize(u="",$="",l="",M=""){return m.replace(/~([\d+]?)/g,"$1").replace(/dtf/,u).replace(/era/,l).replace(/dp\b|~dp\b/,$).replace(/yn\b/,M).replace(/\[(\d+?)]/g,(S,F)=>D[F].trim()).trim()}}},i=n=>n.replace(/\s+/g,""),p=(...n)=>n?.reduce((a,m)=>({...a,...o.retrieveDyn(m)||o.fixed[m]}),o.fixed.dl),c=(n,a,m)=>{let D=p(...i(m).split(",")),u=Intl.DateTimeFormat(D.locale,D).format(n);return a.finalize(u)},g=(n,a,m)=>{let D=p(...a.units.concat(i(m).split(",")).flat()),u={...o.fixed},$=(M,S)=>D[M]==="numeric"&&S.startsWith("0")?S.slice(1):S,l=Intl.DateTimeFormat(D.locale,D).formatToParts(n).reduce((M,S)=>S.type==="literal"?M:{...M,[S.type]:$(S.type,S.value)},{});return u.ms=D.fractionalSecondDigits?u.msp:u.ms,u.yyyy=l.relatedYear?u.ry:u.yyyy,a.formatStr=a.formatStr.replace(o.re,M=>l[Object.keys(u[M]).shift()]||M),a.finalize(void 0,l.dayPeriod,l.era,l.yearName)};return(n,a,m="l:default")=>/ds:|ts:/.test(m)?c(n,d(void 0),m):g(n,d(a||void 0),m)}function j(f){let h=U(),b=(t,e)=>{let y={year:t.getFullYear(),month:t.getMonth()+1,date:t.getDate(),hour:t.getHours(),minutes:t.getMinutes(),seconds:t.getSeconds(),milliseconds:t.getMilliseconds()};return e?Object.values(y):y},r=(t,e)=>(t.localeInfo=!("localeInfo"in t)||e?M(t,e):t.localeInfo,t.localeInfo),s=(t,e)=>{let y=new Date(...D(e??new Date)),T=c(t,!0);return u(new Date(...D(y).concat(T)))},o=(t,e)=>(t=f(t),t.toLocaleString(t.locale.l,{...e??{},timeZone:t.locale.tz})),d=(t,...e)=>{let y=f(t).locale;return e.length===1?h(t,e[0],y.formats):e.length?h(t,...e):t.toLocaleString(y.l)},i=(t,{year:e,month:y,date:T}={})=>{let[C,Y,I]=g(t);t.setFullYear(e||C),t.setMonth((y||Y+1)-1),t.setDate(T||I)},p=z(),c=t=>[t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()],g=t=>[t.getFullYear(),t.getMonth(),t.getDate()],n=(t,e)=>{let y=c(t),T=e?`.${y.pop()}`.padStart(3,"0"):"";return`${y.slice(0,3).map(C=>`${C}`.padStart(2,"0")).join(":")}${T}`},a=function(t,{hour:e,minutes:y,seconds:T,milliseconds:C}={}){let[Y,I,N,O]=c(t);t.setHours(e??Y),t.setMinutes(y??I),t.setSeconds(T??N),t.setMilliseconds(C??O)},m=(t,e)=>f(new Date(t,e+1,1,0,0,0)).yesterday.getDate(),D=t=>[t.getFullYear(),t.getMonth(),t.getDate()],u=t=>f(new Date(t)),$=P(),l=(t,...e)=>f($(t,...e)),M=function(t,{locale:e="utc",timeZone:y="Etc/UTC"}={}){return t.localeInfo={l:e,tz:y,formats:`l:${e},tz:${y}`},t.localeInfo};return{...{clone:u,year:(t,e)=>e&&t.setFullYear(e)||t.getFullYear(),month:(t,e)=>e&&t.setMonth(e-1)||t.getMonth()+1,date:(t,e)=>e&&i(t,e)||t.getDate(t),hour:(t,e)=>e&&t.setHours(e)||t.getHours(),minutes:(t,e)=>e&&t.setMinutes(e)||t.getMinutes(),seconds:(t,e)=>e&&t.setSeconds(e)||t.getSeconds(),cloneDate:t=>u(new Date(...D(t).concat([0,0,0]))),cloneTime:t=>s(t),cloneTimeTo:t=>e=>s(t,e),time:(t,e)=>e&&a(t,e)||c(t),timeStr:t=>(e=!1)=>n(t,e),ms:(t,e)=>e&&t.setMilliseconds(e)||t.getMilliseconds(),monthName:t=>(t=f(t),t.format("MM",`l:${t.locale.l}`)),weekDay:t=>(t=f(t),t.format("WD",`l:${t.locale.l}`)),self:t=>t,local:(t,e)=>o(t,e),locale:(t,e)=>r(t,e),differenceFrom:t=>e=>p({start:t,end:e}),values:t=>e=>b(t,e),UTC:t=>Date.UTC(...b(t,!0)),UTCString:t=>t.toUTCString(),ISO:t=>t.toISOString(),daysInMonth:t=>m(t.getFullYear(),t.getMonth()),isLeapYear:t=>m(t.getFullYear(),1)===29,format:t=>(...e)=>d(t,...e)},...{addYears:t=>(e=1)=>l(t,`${e} years`),addMonths:t=>(e=1)=>l(t,`${e} months`),addWeeks:t=>(e=1)=>l(t,`${e*7} days`),addDays:t=>(e=1)=>l(t,`${e} days`),nextYear:t=>l(t,"1 year"),nextWeek:t=>l(t,"7 days"),previousWeek:t=>l(t,"subtract, 7 days"),previousYear:t=>l(t,"subtract, 1 year"),nextMonth:t=>l(t,"1 month"),previousMonth:t=>l(t,"subtract, 1 month"),tomorrow:t=>l(t,"1 day"),yesterday:t=>l(t,"subtract, 1 day"),add:t=>(...e)=>l(t,...e),subtract:t=>(...e)=>l(t,...["subtract"].concat([e]).flat())}}}function z(){let f=(r,s)=>{let o=isNaN(r),d=isNaN(s);if(o&&!d){let[i,p,c]=Array(3).fill("start and end date are not valid");return{error:!0,message:i,full:p,clean:c}}if(d){let[i,p,c]=Array(3).fill("end date not valid");return{error:!0,message:i,full:p,clean:c}}if(o){let[i,p,c]=Array(3).fill("start date not valid");return{error:!0,message:i,full:p,clean:c}}return{error:!1}},h=b();return function({start:s,end:o}={}){let d=new Date(Date.parse(s)),i=new Date(Date.parse(o)),p=f(d,i);if(p.error)return p;let c=new Date(s),g=new Date(o),n=Math.abs(g-c),a=new Date(n),m=a.getUTCFullYear()-1970,D=a.getUTCMonth(),u=a.getUTCDate()-1,$=a.getUTCHours(),l=a.getUTCMinutes(),M=a.getUTCSeconds(),S=a.getUTCMilliseconds(),F={years:m,months:D,days:u,hours:$,minutes:l,seconds:M,milliseconds:S};return F.full=h({values:F,full:!0}),F.clean=h({values:F}),F};function b(){let r=(...c)=>g=>c.reduce((n,a)=>a(n),g),s=(c,g)=>c===1?g.slice(0,-1):g;return r(({values:c,full:g})=>[Object.entries(c).filter(([n])=>/^(years|month|days|hours|minutes|seconds)/i.test(n)),g],([c,g])=>g?c:c.filter(([,n])=>g?+n:n>0),c=>c.reduce((g,[n,a])=>[...g,`${a} ${s(a,n)}`],[]),c=>c.length<1?"Dates are equal":`${c.slice(0,-1).join(", ")}${c.length>1?" and ":""}${c.slice(-1).shift()}`)}}function P(){let f=Object.entries({year:"FullYear",month:"Month",date:"Date",day:"Date",hour:"Hours",minute:"Minutes",second:"Seconds",millisecond:"Milliseconds"}).reduce((r,[s,o])=>({...r,[s]:o,[`${s}s`]:o}),{}),h=function(...r){if(r.length<1)return[];let s;(r[0]==="subtract"||r[0].startsWith("subtract"))&&(s=!0,r[0].startsWith("subtract")&&r.length===1&&(r=r[0].split(",")),r=r.slice(1));let o=r.length===1?r[0]?.split(/,/):r;return o&&o.length&&(r=o.map(d=>d.trim())),r.map(function(d){return d.toLowerCase().split(/\s/).map(i=>(i=i.trim(),+i?s?-i:+i:i))})};return function(r,...s){let o=h(...s);return o.length&&o.forEach(([d,i])=>{i=f[i],+d&&i&&r[`set${i}`](r[`get${i}`]()+ +d)}),r}}
