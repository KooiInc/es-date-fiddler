var A=J;function J(){let l=Object.entries({year:"FullYear",month:"Month",date:"Date",day:"Date",hour:"Hours",minute:"Minutes",second:"Seconds",millisecond:"Milliseconds"}).reduce((u,[y,i])=>({...u,[y]:i,[`${y}s`]:i}),{}),p=function(...u){if(u.length<1)return[];let y;u[0].startsWith("subtract")&&(y=!0,u[0].startsWith("subtract")&&u.length===1&&(u=u[0].split(",")),u=u.slice(1));let i=u.length===1?u[0]?.split(/,/):u;return i&&i.length&&(u=i.map(m=>m.trim())),u.map(function(m){return m.toLowerCase().split(/\s/).map(f=>(f=f.trim(),+f?y?-f:+f:f))})};return function(u,...y){let i=p(...y);return i.length&&i.forEach(([m,f])=>{f=l[f],+m&&f&&u[`set${f}`](u[`get${f}`]()+ +m)}),u}}var W=Q;function Q(){let l=(y,i)=>{let m=isNaN(y),f=isNaN(i);if(m&&!f){let[r,c,s]=Array(3).fill("start- and/or end date are not valid");return{error:!0,message:r,full:c,clean:s}}if(f){let[r,c,s]=Array(3).fill("end date not valid");return{error:!0,message:r,full:c,clean:s}}if(m){let[r,c,s]=Array(3).fill("start date not valid");return{error:!0,message:r,full:c,clean:s}}return{error:!1}},p=u();return function({start:i,end:m}={}){let f=new Date(Date.parse(i)),r=new Date(Date.parse(m)),c=l(f,r);if(c.error)return c;let s=new Date(i),d=new Date(m),n=Math.abs(d-s),a=new Date(n),g=a.getUTCFullYear()-1970,M=a.getUTCMonth(),D=a.getUTCDate()-1,N=a.getUTCHours(),b=a.getUTCMinutes(),F=a.getUTCSeconds(),I=a.getUTCMilliseconds(),T={from:s,to:d,years:g,months:M,days:D,hours:N,minutes:b,seconds:F,milliseconds:I};return T.full=p({values:T,full:!0}),T.clean=p({values:T}),T};function u(){let y=(...s)=>d=>s.reduce((n,a)=>a(n),d),i=(s,d)=>s===1?d.slice(0,-1):d;return y(({values:s,full:d})=>[Object.entries(s).filter(([n])=>/^(years|month|days|hours|minutes|seconds)/i.test(n)),d],([s,d])=>d?s:s.filter(([,n])=>d?+n:n>0),s=>s.reduce((d,[n,a])=>[...d,`${a} ${i(a,n)}`],[]),s=>s.length<1?"Dates are equal":`${s.slice(0,-1).join(", ")}${s.length>1?" and ":""}${s.slice(-1).shift()}`)}}var re=j();function j(){let[l,p,u,y]=["2-digit","numeric","long","short"],i={fixed:{MM:{month:u},M:{month:y},m:{month:p},mm:{month:l},yyyy:{year:p},yy:{year:l},WD:{weekday:u},wd:{weekday:y},d:{day:p},dd:{day:l},h:{hour:p},hh:{hour:l},mi:{minute:p},mmi:{minute:l},s:{second:p},ss:{second:l},ms:{fractionalSecondDigits:3},tz:{timeZoneName:"shortOffset"},dl:{locale:"default"},h12:{hour12:!1},yn:{yearName:""},ry:{relatedYear:!0},msp:{fractionalSecond:!0}},dynamic:{tzn:n=>({timeZoneName:n.slice(4)}),hrc:n=>({hourCycle:`h${n.slice(4)}`}),ds:n=>({dateStyle:n.slice(3)}),ts:n=>({timeStyle:n.slice(3)}),tz:n=>({timeZone:n.slice(3)}),e:n=>({era:n.slice(2)}),l:n=>({locale:n.slice(2)})}},m={...i,retrieveDyn(n){let a=n?.slice(0,n.indexOf(":"));return i.dynamic[a]&&i.dynamic[a](n)},get re(){return new RegExp(`\\b(${Object.keys(i.fixed).join("|")})\\b`,"g")}},f=(n="dtf",a=0)=>{let g=` ${n.replace(/(?<=\{)(.+?)(?=})/g,D=>`[${a++}]`).replace(/[{}]/g,"").trim()} `,M=n.match(/(?<=\{)(.+?)(?=})/g)||[];return{get texts(){return M},formatString(D){g=D},set formatStr(D){g=D},get formatStr(){return g},get units(){return g.match(m.re)||[]},finalize(D="",N="",b="",F=""){return g.replace(/~([\d+]?)/g,"$1").replace(/dtf/,D).replace(/era/,b).replace(/dp\b|~dp\b/,N).replace(/yn\b/,F).replace(/\[(\d+?)]/g,(I,T)=>M[T].trim()).trim()}}},r=n=>n.replace(/\s+/g,""),c=(...n)=>n?.reduce((a,g)=>({...a,...m.retrieveDyn(g)||m.fixed[g]}),m.fixed.dl),s=(n,a,g)=>{let M=c(...r(g).split(",")),D=Intl.DateTimeFormat(M.locale,M).format(n);return a.finalize(D)},d=(n,a,g)=>{let M=c(...a.units.concat(r(g).split(",")).flat()),D={...m.fixed},N=(F,I)=>M[F]==="numeric"&&I.startsWith("0")?I.slice(1):I,b=Intl.DateTimeFormat(M.locale,M).formatToParts(n).reduce((F,I)=>I.type==="literal"?F:{...F,[I.type]:N(I.type,I.value)},{});return D.ms=M.fractionalSecondDigits?D.msp:D.ms,D.yyyy=b.relatedYear?D.ry:D.yyyy,a.formatStr=a.formatStr.replace(m.re,F=>b[Object.keys(D[F]).shift()]||F),a.finalize(void 0,b.dayPeriod,b.era,b.yearName)};return(n,a,g="l:default")=>/ds:|ts:/.test(g)?s(n,f(void 0),g):d(n,f(a||void 0),g)}var P=V;function V(l){let p=j(),u=e=>!(isNaN(parseInt(e))&&isNaN(+e)),y=e=>e?.constructor===Object,i=e=>+e.slice(e.indexOf("+")+1).replace(":","")||0,m=e=>e.localeInfo?.timeZone||Intl.DateTimeFormat().resolvedOptions().timeZone,f=(e,t=2)=>`${e}`.padStart(t,"0"),r=e=>e.map(t=>String(t)?.padStart(2,"0")??t),c=e=>r(Y(e)).join("-"),s=e=>Object.entries(e).filter(([,t])=>u(t)),d=(e,t)=>{let o={year:e.getFullYear(),month:e.getMonth()+1,date:e.getDate(),hour:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds(),milliseconds:e.getMilliseconds()};return t?Object.values(o):o},n=e=>{let t={timeZone:m(e),hour12:!1},o;try{return l(new Date(new Date(e.toLocaleString("en",t))))}catch(h){return console.error(`Can't retrieve localized date/time value for ${t.timeZone}: ${h.message}`),l(e)}},a=e=>console.error(`clone${e?"Time":"Date"}To: no toDate given`),g=(e,t)=>{t=l(t??new Date);let o=l(e);if(t){let[h,S,w]=o.date;return t.date={year:h,month:S,date:w},o.locale&&(t.locale={locale:o.locale.locale,timeZone:o.locale.timeZone}),t}return a(),o},M=(e,t)=>{t=l(t??new Date);let o=l(e),{hour:h,minutes:S,seconds:w,ms:Z}=o;return t.time={hour:h,minutes:S,seconds:w,ms:Z},o.locale?(t.locale={locale:o.locale.locale,timeZone:o.locale.timeZone},t):(a(1),o)},D=function(e){let o=O(e)?.replace(/l:/,"locale: ").replace(/tz:/,"timeZone: ");return e.toLocaleString()+` !!invalid locale info => ${o}`},N=e=>{e=l(e);let t={};return e.locale?(e.locale?.timeZone&&(t={timeZone:e.locale.timeZone}),e.toLocaleString(e.locale?.locale,t)):e.toLocaleString()},b=(e,...t)=>{e=l(e);let[o,h]=[e.locale,e.timeZone],S=O(e);return t.length===1?p(e,t[0],S||void 0):t.length?p(e,...t):e.toLocaleString(o||[],h?{timeZone:h}:void 0)},F=e=>console.error(`invalid locale (time zone: "${e.timeZone}", locale: "${e.locale}"), removed associated locale information`),I=(e,t=!1)=>{if(!e.localeInfo)return!0;e="values"in e?e:l(e);try{let o=new Date(e).toLocaleString(e.localeInfo.locale??[],{timeZone:e.localeInfo.timeZone});return e}catch{return F(e.localeInfo),e.removeLocale()}},T=(e,t)=>y(t)&&s(t).forEach(([o,h])=>e[`set${o}`](h))&&!0||!1,z=e=>[e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()??0],Y=e=>[e.getFullYear(),e.getMonth()+1,e.getDate()],H=(e,t)=>T(e,t)||z(e),E=(e,t)=>T(e,t)||Y(e),U=W(),C=(e,t)=>l(new Date(e,t+1,1,0,0,0)).yesterday.getDate(),ee=e=>[e.getFullYear(),e.getMonth(),e.getDate()],k=e=>{let t=l(new Date(e));return t.relocate(e.localeInfo??{timezone:m(e)}),t},X=A(),$=(e,...t)=>l(X(e,...t)),x=(e,{locale:t,timeZone:o}={})=>((t||o)&&(e.localeInfo=_(e,{locale:t,timeZone:o}),I(e)),e.localeInfo??{}),O=e=>{let[t,o]=[e.localeInfo?.locale,e.localeInfo?.timeZone];return[`${t?`l:${t}`:""}`,`${o?`tz:${o}`:""}`].filter(h=>h).join(", ")?.trim()},_=function(e,{locale:t,timeZone:o}={}){[t,o]=[t||e.localeInfo?.locale,o||e.localeInfo?.timeZone||m(e)];let h=[`${t?`l:${t}`:""}`,`${o?`tz:${o}`:""}`].filter(S=>S).join(", ");return e.localeInfo={...t?{locale:t}:{},...o?{timeZone:o}:{}},e.localeInfo.formats=O(e),e.localeInfo},q=e=>(delete e.localeInfo,l(e)),G=function(e,t,o){return x(e,{locale:t,timeZone:o}),l(e)},L=function(e,t){return e=l(e),e.format(t?"MM":"WD",`l:${e.locale?.locale||"utc"}`)},K=e=>e.toLocaleDateString().split(/[-\/]/).map(t=>f(t)).join("-"),B=(e,t)=>{let o=z(e).reduce((h,S,w)=>[...h,w<3?f(S):f(S,3)],[]);return`${o.slice(0,3).join(":")}${t?`.${o.slice(-1)}`:""}`};return{clone:k,localizedDT:n,hasDST:e=>{let t=m(e),o=new Date(e.getFullYear(),0,1,14),h=new Date(new Date(o).setMonth(6)),S=Intl.DateTimeFormat("en-CA",{year:"numeric",timeZone:t,timeZoneName:"shortOffset"}),[w,Z]=[S.format(o),S.format(h)];return i(w)-i(Z)!==0},getTimezone:m,dateStr:K,year:(e,t)=>t&&e.setFullYear(t)||e.getFullYear(),month:(e,t)=>t&&e.setMonth(v-1)||e.getMonth()+1,date:(e,{year:t,month:o,date:h}={})=>E(e,{FullYear:t,Month:u(o)?o-1:o,Date:h}),hour:(e,t)=>t&&e.setHours(t)||e.getHours(),minutes:(e,t)=>t&&e.setMinutes(t)||e.getMinutes(),seconds:(e,t)=>t&&e.setSeconds(t)||e.getSeconds(),cloneTimeTo:e=>t=>M(e,t),cloneDateTo:e=>t=>g(e,t),time:(e,{hour:t,minutes:o,seconds:h,milliseconds:S}={})=>H(e,{Hours:t,Minutes:o,Seconds:h,Milliseconds:S}),timeStr:e=>(t=!1)=>B(e,t),dateISOStr:e=>c(e),ms:(e,t)=>t&&e.setMilliseconds(t)||e.getMilliseconds(),monthName:e=>L(e,!0),weekDay:e=>L(e),self:e=>e,local:e=>N(e),locale:(e,{locale:t,timeZone:o}={})=>x(e,{locale:t,timeZone:o}),removeLocale:e=>()=>q(e),relocate:e=>({locale:t,timeZone:o}={})=>G(e,t,o),differenceFrom:e=>t=>U({start:e,end:t}),values:e=>t=>d(e,t),ISO:e=>e.toISOString(),daysInMonth:e=>C(e.getFullYear(),e.getMonth()),isLeapYear:e=>C(e.getFullYear(),1)===29,format:e=>(...t)=>b(e,...t),addYears:e=>(t=1)=>$(e,`${t} years`),addMonths:e=>(t=1)=>$(e,`${t} months`),addWeeks:e=>(t=1)=>$(e,`${t*7} days`),addDays:e=>(t=1)=>$(e,`${t} days`),nextYear:e=>$(e,"1 year"),nextWeek:e=>$(e,"7 days"),previousWeek:e=>$(e,"subtract, 7 days"),previousYear:e=>$(e,"subtract, 1 year"),nextMonth:e=>$(e,"1 month"),previousMonth:e=>$(e,"subtract, 1 month"),tomorrow:e=>$(e,"1 day"),yesterday:e=>$(e,"subtract, 1 day"),add:e=>(...t)=>$(e,...t),subtract:e=>(...t)=>$(e,...["subtract"].concat([t]).flat())}}var fe=R();function R(){let l=P(i),p={get:(r,c)=>r[c]?m(r,c):l[c]?.(r),set:(r,c,s)=>l[c]?l[c](r,s):r[c],ownKeys:r=>Object.getOwnPropertyNames(l),has:(r,c)=>c in l||c in r};function u({name:r,fn:c,isMethod:s=!1,proxifyResult:d=!1}={}){if(!r||!c||!(c instanceof Function))return console.error("es-date-fiddler (extendWith): cannot extend without name and/or fn (function)");l[r]=n=>(n=i(n),n.localeInfo&&n.relocate(n.localeInfo),s?(...a)=>d?i(c(n,...a)):c(n,...a):d?i(c(n)):c(n))}function y(){return f()}function i(r){return new Proxy(r,p)}function m(r,c){return c in r&&r[c]instanceof Function?r[c].bind(r):r[c]}function f(r,c){let s=r?.locale||r?.timeZone,d=(r||"")instanceof Date,n=s?new Date:new Date(d?r:Date.parse(r)),a=isNaN(n)?new Date(Date.now()):n,g=i(a);return(s||c)&&(g.locale=s?r:c),g}return Object.defineProperties(f,{now:{get(){return y()}},extendWith:{get(){return u}}}),f}export{R as DateXFactory,fe as default};
