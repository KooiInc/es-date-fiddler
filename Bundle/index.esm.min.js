var N=H;function H(){let u=Object.entries({year:"FullYear",month:"Month",date:"Date",day:"Date",hour:"Hours",minute:"Minutes",second:"Seconds",millisecond:"Milliseconds"}).reduce((s,[o,r])=>({...s,[o]:r,[`${o}s`]:r}),{}),h=function(...s){if(s.length<1)return[];let o;(s[0]==="subtract"||s[0].startsWith("subtract"))&&(o=!0,s[0].startsWith("subtract")&&s.length===1&&(s=s[0].split(",")),s=s.slice(1));let r=s.length===1?s[0]?.split(/,/):s;return r&&r.length&&(s=r.map(f=>f.trim())),s.map(function(f){return f.toLowerCase().split(/\s/).map(l=>(l=l.trim(),+l?o?-l:+l:l))})};return function(s,...o){let r=h(...o);return r.length&&r.forEach(([f,l])=>{l=u[l],+f&&l&&s[`set${l}`](s[`get${l}`]()+ +f)}),s}}var w=P;function P(){let u=(s,o)=>{let r=isNaN(s),f=isNaN(o);if(r&&!f){let[l,D,c]=Array(3).fill("start and end date are not valid");return{error:!0,message:l,full:D,clean:c}}if(f){let[l,D,c]=Array(3).fill("end date not valid");return{error:!0,message:l,full:D,clean:c}}if(r){let[l,D,c]=Array(3).fill("start date not valid");return{error:!0,message:l,full:D,clean:c}}return{error:!1}},h=F();return function({start:o,end:r}={}){let f=new Date(Date.parse(o)),l=new Date(Date.parse(r)),D=u(f,l);if(D.error)return D;let c=new Date(o),m=new Date(r),n=Math.abs(m-c),a=new Date(n),g=a.getUTCFullYear()-1970,p=a.getUTCMonth(),d=a.getUTCDate()-1,$=a.getUTCHours(),S=a.getUTCMinutes(),i=a.getUTCSeconds(),M=a.getUTCMilliseconds(),T={years:g,months:p,days:d,hours:$,minutes:S,seconds:i,milliseconds:M};return T.full=h({values:T,full:!0}),T.clean=h({values:T}),T};function F(){let s=(...c)=>m=>c.reduce((n,a)=>a(n),m),o=(c,m)=>c===1?m.slice(0,-1):m;return s(({values:c,full:m})=>[Object.entries(c).filter(([n])=>/^(years|month|days|hours|minutes|seconds)/i.test(n)),m],([c,m])=>m?c:c.filter(([,n])=>m?+n:n>0),c=>c.reduce((m,[n,a])=>[...m,`${a} ${o(a,n)}`],[]),c=>c.length<1?"Dates are equal":`${c.slice(0,-1).join(", ")}${c.length>1?" and ":""}${c.slice(-1).shift()}`)}}var k=I();function I(){let[u,h,F,s]=["2-digit","numeric","long","short"],o={fixed:{MM:{month:F},M:{month:s},m:{month:h},mm:{month:u},yyyy:{year:h},yy:{year:u},WD:{weekday:F},wd:{weekday:s},d:{day:h},dd:{day:u},h:{hour:h},hh:{hour:u},mi:{minute:h},mmi:{minute:u},s:{second:h},ss:{second:u},ms:{fractionalSecondDigits:3},tz:{timeZoneName:"shortOffset"},dl:{locale:"default"},h12:{hour12:!1},yn:{yearName:""},ry:{relatedYear:!0},msp:{fractionalSecond:!0}},dynamic:{tzn:n=>({timeZoneName:n.slice(4)}),hrc:n=>({hourCycle:`h${n.slice(4)}`}),ds:n=>({dateStyle:n.slice(3)}),ts:n=>({timeStyle:n.slice(3)}),tz:n=>({timeZone:n.slice(3)}),e:n=>({era:n.slice(2)}),l:n=>({locale:n.slice(2)})}},r={...o,retrieveDyn(n){let a=n?.slice(0,n.indexOf(":"));return o.dynamic[a]&&o.dynamic[a](n)},get re(){return new RegExp(`\\b(${Object.keys(o.fixed).join("|")})\\b`,"g")}},f=(n="dtf",a=0)=>{let g=` ${n.replace(/(?<=\{)(.+?)(?=})/g,d=>`[${a++}]`).replace(/[{}]/g,"").trim()} `,p=n.match(/(?<=\{)(.+?)(?=})/g)||[];return{get texts(){return p},formatString(d){g=d},set formatStr(d){g=d},get formatStr(){return g},get units(){return g.match(r.re)||[]},finalize(d="",$="",S="",i=""){return g.replace(/~([\d+]?)/g,"$1").replace(/dtf/,d).replace(/era/,S).replace(/dp\b|~dp\b/,$).replace(/yn\b/,i).replace(/\[(\d+?)]/g,(M,T)=>p[T].trim()).trim()}}},l=n=>n.replace(/\s+/g,""),D=(...n)=>n?.reduce((a,g)=>({...a,...r.retrieveDyn(g)||r.fixed[g]}),r.fixed.dl),c=(n,a,g)=>{let p=D(...l(g).split(",")),d=Intl.DateTimeFormat(p.locale,p).format(n);return a.finalize(d)},m=(n,a,g)=>{let p=D(...a.units.concat(l(g).split(",")).flat()),d={...r.fixed},$=(i,M)=>p[i]==="numeric"&&M.startsWith("0")?M.slice(1):M,S=Intl.DateTimeFormat(p.locale,p).formatToParts(n).reduce((i,M)=>M.type==="literal"?i:{...i,[M.type]:$(M.type,M.value)},{});return d.ms=p.fractionalSecondDigits?d.msp:d.ms,d.yyyy=S.relatedYear?d.ry:d.yyyy,a.formatStr=a.formatStr.replace(r.re,i=>S[Object.keys(d[i]).shift()]||i),a.finalize(void 0,S.dayPeriod,S.era,S.yearName)};return(n,a,g="l:default")=>/ds:|ts:/.test(g)?c(n,f(void 0),g):m(n,f(a||void 0),g)}var z=W;function W(u){let h=I(),F=(t,e)=>{let y={year:t.getFullYear(),month:t.getMonth()+1,date:t.getDate(),hour:t.getHours(),minutes:t.getMinutes(),seconds:t.getSeconds(),milliseconds:t.getMilliseconds()};return e?Object.values(y):y},s=(t,e)=>(e&&(t.localeInfo=M(t,e)),t.localeInfo),o=(t,e)=>{e=u(e??new Date);let y=u(t);if(e){let{year:b,month:x,date:Y}=y;e.date={year:b,month:x,date:Y}}return e},r=(t,e)=>{let y=new Date(...d(e??new Date)),b=m(t,!0);return $(new Date(...d(y).concat(b)))},f=(t,e)=>(t=u(t),t.locale?(t.locale?.tz&&(e={...e??{},timeZone:t.locale.tz}),t.toLocaleString(t.locale.l,e)):t.toLocaleString()),l=(t,...e)=>{let y=u(t).locale;return e.length===1?h(t,e[0],y?.formats):e.length?h(t,...e):t.toLocaleString(y?.l)},D=(t,{year:e,month:y,date:b}={})=>{let[x,Y,C]=n(t);t.setFullYear(e||x),t.setMonth((y||Y+1)-1),t.setDate(b||C)},c=w(),m=t=>[t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()],n=t=>[t.getFullYear(),t.getMonth(),t.getDate()],a=(t,e)=>{let y=m(t),b=e?`.${y.pop()}`.padStart(3,"0"):"";return`${y.slice(0,3).map(x=>`${x}`.padStart(2,"0")).join(":")}${b}`},g=function(t,{hour:e,minutes:y,seconds:b,milliseconds:x}={}){let[Y,C,O,j]=m(t);t.setHours(e??Y),t.setMinutes(y??C),t.setSeconds(b??O),t.setMilliseconds(x??j)},p=(t,e)=>u(new Date(t,e+1,1,0,0,0)).yesterday.getDate(),d=t=>[t.getFullYear(),t.getMonth(),t.getDate()],$=t=>u(new Date(t)),S=N(),i=(t,...e)=>u(S(t,...e)),M=function(t,{locale:e="utc",timeZone:y="Etc/UTC"}={}){return t.localeInfo={l:e,tz:y,formats:`l:${e},tz:${y}`},t.localeInfo};return{...{clone:$,year:(t,e)=>e&&t.setFullYear(e)||t.getFullYear(),month:(t,e)=>e&&t.setMonth(e-1)||t.getMonth()+1,date:(t,e)=>e&&D(t,e)||t.getDate(t),hour:(t,e)=>e&&t.setHours(e)||t.getHours(),minutes:(t,e)=>e&&t.setMinutes(e)||t.getMinutes(),seconds:(t,e)=>e&&t.setSeconds(e)||t.getSeconds(),cloneTimeTo:t=>e=>r(t,e),cloneDateTo:t=>e=>o(t,e),time:(t,e)=>e&&g(t,e)||m(t),timeStr:t=>(e=!1)=>a(t,e),ms:(t,e)=>e&&t.setMilliseconds(e)||t.getMilliseconds(),monthName:t=>(t=u(t),t.format("MM",`l:${t.locale?.l||"utc"}`)),weekDay:t=>(t=u(t),t.format("WD",`l:${t.locale?.l||"utc"}`)),self:t=>t,local:(t,e)=>f(t,e),locale:(t,e)=>s(t,e),differenceFrom:t=>e=>c({start:t,end:e}),values:t=>e=>F(t,e),ISO:t=>t.toISOString(),daysInMonth:t=>p(t.getFullYear(),t.getMonth()),isLeapYear:t=>p(t.getFullYear(),1)===29,format:t=>(...e)=>l(t,...e)},...{addYears:t=>(e=1)=>i(t,`${e} years`),addMonths:t=>(e=1)=>i(t,`${e} months`),addWeeks:t=>(e=1)=>i(t,`${e*7} days`),addDays:t=>(e=1)=>i(t,`${e} days`),nextYear:t=>i(t,"1 year"),nextWeek:t=>i(t,"7 days"),previousWeek:t=>i(t,"subtract, 7 days"),previousYear:t=>i(t,"subtract, 1 year"),nextMonth:t=>i(t,"1 month"),previousMonth:t=>i(t,"subtract, 1 month"),tomorrow:t=>i(t,"1 day"),yesterday:t=>i(t,"subtract, 1 day"),add:t=>(...e)=>i(t,...e),subtract:t=>(...e)=>i(t,...["subtract"].concat([e]).flat())}}}var J=A();function A(){let u=z(F),h={get:(o,r)=>!o[r]&&u[r]?.(o)||s(o,r),set:(o,r,f)=>u[r]?.(o,f)||o[r]};return function(o,r){let f=o?.locale||o?.timeZone,l=f?new Date:new Date(Date.parse(o)),D=isNaN(l)?new Date(Date.now()):l,c=F(D);return(f||r)&&(c.locale=f?o:r),c};function F(o){return new Proxy(o,h)}function s(o,r){return r in o&&o[r]instanceof Function?o[r].bind(o):o[r]}}export{A as DateFiddlerFactory,J as default};
