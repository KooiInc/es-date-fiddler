var A=B;function B(){let l=Object.entries({year:"FullYear",month:"Month",date:"Date",day:"Date",hour:"Hours",minute:"Minutes",second:"Seconds",millisecond:"Milliseconds"}).reduce((u,[h,m])=>({...u,[h]:m,[`${h}s`]:m}),{}),S=function(...u){if(u.length<1)return[];let h;u[0].startsWith("subtract")&&(h=!0,u[0].startsWith("subtract")&&u.length===1&&(u=u[0].split(",")),u=u.slice(1));let m=u.length===1?u[0]?.split(/,/):u;return m&&m.length&&(u=m.map(d=>d.trim())),u.map(function(d){return d.toLowerCase().split(/\s/).map(i=>(i=i.trim(),parseInt(i)?h?-i:+i:i))})};return function(u,...h){let m=S(...h);return m.length&&m.forEach(([d,i])=>{i=l[i],+d&&i&&u[`set${i}`](u[`get${i}`]()+ +d)}),u}}var L=J;function J(){let l=(h,m)=>{let d=isNaN(h),i=isNaN(m);if(d&&!i){let[p,D,n]=Array(3).fill("start- and/or end date are not valid");return{error:!0,message:p,full:D,clean:n}}if(i){let[p,D,n]=Array(3).fill("end date not valid");return{error:!0,message:p,full:D,clean:n}}if(d){let[p,D,n]=Array(3).fill("start date not valid");return{error:!0,message:p,full:D,clean:n}}return{error:!1}},S=u();return function({start:m,end:d}={}){let i=new Date(Date.parse(m)),p=new Date(Date.parse(d)),D=l(i,p);if(D.error)return D;let n=new Date(m),r=new Date(d),o=Math.abs(r-n),a=new Date(o),c=a.getUTCFullYear()-1970,y=a.getUTCMonth(),g=a.getUTCDate()-1,T=a.getUTCHours(),I=a.getUTCMinutes(),$=a.getUTCSeconds(),F=a.getUTCMilliseconds(),O={from:n,to:r,years:c,months:y,days:g,hours:T,minutes:I,seconds:$,milliseconds:F};return O.full=S({values:O,full:!0}),O.clean=S({values:O}),O};function u(){let h=(...n)=>r=>n.reduce((o,a)=>a(o),r),m=(n,r)=>n===1?r.slice(0,-1):r;return h(({values:n,full:r})=>[Object.entries(n).filter(([o])=>/^(years|month|days|hours|minutes|seconds)/i.test(o)),r],([n,r])=>r?n:n.filter(([,o])=>r?+o:o>0),n=>n.reduce((r,[o,a])=>[...r,`${a} ${m(a,o)}`],[]),n=>n.length<1?"Dates are equal":`${n.slice(0,-1).join(", ")}${n.length>1?" and ":""}${n.slice(-1).shift()}`)}}var oe=w();function w(){let[l,S,u,h]=["2-digit","numeric","long","short"],m={fixed:{MM:{month:u},M:{month:h},m:{month:S},mm:{month:l},yyyy:{year:S},yy:{year:l},WD:{weekday:u},wd:{weekday:h},d:{day:S},dd:{day:l},h:{hour:S},hh:{hour:l},mi:{minute:S},mmi:{minute:l},s:{second:S},ss:{second:l},ms:{fractionalSecondDigits:3},tz:{timeZoneName:"shortOffset"},dl:{locale:"default"},h12:{hour12:!1},yn:{yearName:""},ry:{relatedYear:!0},msp:{fractionalSecond:!0}},dynamic:{tzn:o=>({timeZoneName:o.slice(4)}),hrc:o=>({hourCycle:`h${o.slice(4)}`}),ds:o=>({dateStyle:o.slice(3)}),ts:o=>({timeStyle:o.slice(3)}),tz:o=>({timeZone:o.slice(3)}),e:o=>({era:o.slice(2)}),l:o=>({locale:o.slice(2)})}},d={...m,retrieveDyn(o){let a=o?.slice(0,o.indexOf(":"));return m.dynamic[a]&&m.dynamic[a](o)},get re(){return new RegExp(`\\b(${Object.keys(m.fixed).join("|")})\\b`,"g")}},i=(o="dtf",a=0)=>{let c=` ${o.replace(/(?<=\{)(.+?)(?=})/g,g=>`[${a++}]`).replace(/[{}]/g,"").trim()} `,y=o.match(/(?<=\{)(.+?)(?=})/g)||[];return{get texts(){return y},formatString(g){c=g},set formatStr(g){c=g},get formatStr(){return c},get units(){return c.match(d.re)||[]},finalize(g="",T="",I="",$=""){return c.replace(/~([\d+]?)/g,"$1").replace(/dtf/,g).replace(/era/,I).replace(/dp\b|~dp\b/,T).replace(/yn\b/,$).replace(/\[(\d+?)]/g,(F,O)=>y[O].trim()).trim()}}},p=o=>o.replace(/\s+/g,""),D=(...o)=>o?.reduce((a,c)=>({...a,...d.retrieveDyn(c)||d.fixed[c]}),d.fixed.dl),n=(o,a,c)=>{let y=D(...p(c).split(",")),g=Intl.DateTimeFormat(y.locale,y).format(o);return a.finalize(g)},r=(o,a,c)=>{let y=D(...a.units.concat(p(c).split(",")).flat()),g={...d.fixed},T=($,F)=>y[$]==="numeric"&&F.startsWith("0")?F.slice(1):F,I=Intl.DateTimeFormat(y.locale,y).formatToParts(o).reduce(($,F)=>F.type==="literal"?$:{...$,[F.type]:T(F.type,F.value)},{});return g.ms=y.fractionalSecondDigits?g.msp:g.ms,g.yyyy=I.relatedYear?g.ry:g.yyyy,a.formatStr=a.formatStr.replace(d.re,$=>I[Object.keys(g[$]).shift()]||$),a.finalize(void 0,I.dayPeriod,I.era,I.yearName)};return(o,a,c="l:default")=>/ds:|ts:/.test(c)?n(o,i(void 0),c):r(o,i(a||void 0),c)}var P=Q;function Q(l,S){let u=!0,h=w(),m=e=>!(isNaN(parseInt(e))&&isNaN(+e)),d=e=>e?.constructor===Object,i=e=>+e.slice(e.indexOf("+")+1).replace(":","")||0,p=e=>e.localeInfo?.timeZone||Intl.DateTimeFormat().resolvedOptions().timeZone,D=(e,t=2)=>`${e}`.padStart(t,"0"),n=e=>e.map(t=>String(t)?.padStart(2,"0")??t),r=e=>n(j(e)).join("-"),o=e=>Object.entries(e).filter(([,t])=>m(t)),a=(e,t)=>{let s={year:e.getFullYear(),month:e.getMonth()+1,date:e.getDate(),hour:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds(),milliseconds:e.getMilliseconds()};return t?Object.values(s):s},c=e=>{let t={timeZone:p(e),hourCycle:"h23"},s;try{return l(new Date(new Date(e.toLocaleString("en",t))))}catch(f){return console.error(`Can't retrieve localized date/time value for ${t.timeZone}: ${f.message}`),l(e)}},y=e=>console.error(`clone${e?"Time":"Date"}To: no toDate given`),g=(e,t)=>{t=l(t??new Date);let s=l(e);if(t){let[f,M,Z]=s.date;return t.date={year:f,month:M,date:Z},s.locale&&(t.locale={locale:s.locale.locale,timeZone:s.locale.timeZone}),t}return y(),s},T=(e,t)=>{t=l(t??new Date);let s=l(e),{hour:f,minutes:M,seconds:Z,ms:N}=s;return t.time={hour:f,minutes:M,seconds:Z,ms:N},s.locale?(t.locale={locale:s.locale.locale,timeZone:s.locale.timeZone},t):(y(1),s)},I=e=>{e=l(e);let t={};if(!e.locale)return e.toLocaleString();let{locale:s,timeZone:f}=e.locale;return e.locale?.timeZone&&(t={timeZone:e.locale.timeZone}),e.toLocaleString(s,t)},$=(e,...t)=>{e=l(e);let s,f,M;return e.locale&&(s=e.locale.locale,f=e.locale.timeZone,M=e.formats),t.length===1?h(e,t[0],M):t.length?h(e,...t):e.toLocaleString(s||[],f?{timeZone:f}:void 0)},F=(e,t)=>d(t)&&o(t).forEach(([s,f])=>e[`set${s}`](f))&&!0||!1,O=e=>[e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()??0],j=e=>[e.getFullYear(),e.getMonth()+1,e.getDate()],W=(e,t)=>F(e,t)||O(e),H=(e,t)=>F(e,t)||j(e),E=L(),Y=(e,t)=>l(new Date(e,t+1,1,0,0,0)).yesterday.getDate(),R=e=>[e.getFullYear(),e.getMonth(),e.getDate()],U=e=>l(new Date(e)).relocate(e.localeInfo),k=A(),b=(e,...t)=>l(k(e,...t)),z=(e,t)=>[`${e&&!(Array.isArray(e)&&e.length<1)?`l:${e}`:""}`,`${t?`tz:${t}`:""}`].filter(s=>s).join(","),G=function(e,{locale:t,timeZone:s}={}){if(t||s){let f=S(t||[],s);e.localeInfo={locale:f?.locale||navigator?.language||"en",timeZone:f?.timeZone||Intl.DateTimeFormat().resolvedOptions().timeZone},e.formats=z(e.localeInfo.locale,e.localeInfo.timeZone)}return e.localeInfo??void 0},C=(e,{locale:t,timeZone:s,validate:f=!0}={})=>((t||s)&&(e.localeInfo=G(e,{locale:t,timeZone:s,validate:f})),e.localeInfo),X=e=>(delete e.localeInfo,l(e)),_=function(e,t,s,f){return(t||s)&&C(e,{locale:t,timeZone:s}),l(e)},x=function(e,t){return e=l(e),e.format(t?"MM":"WD",`l:${e.locale?.locale||"utc"}`)},q=e=>{let t={};if(e=l(e),!e.locale)return e.toLocaleDateString();let{locale:s,timeZone:f}=e.locale;return e.locale?.timeZone&&(t={timeZone:e.locale.timeZone}),e.toLocaleDateString(s,t)},K=(e,t)=>{let s=O(e).reduce((f,M,Z)=>[...f,Z<3?D(M):D(M,3)],[]);return`${s.slice(0,3).join(":")}${t?`.${s.slice(-1)}`:""}`};return{clone:U,localizedDT:c,hasDST:e=>{let t=p(e),s=new Date(e.getFullYear(),0,1,14),f=new Date(new Date(s).setMonth(6)),M=Intl.DateTimeFormat("en-CA",{year:"numeric",timeZone:t,timeZoneName:"shortOffset"}),[Z,N]=[M.format(s),M.format(f)];return i(Z)-i(N)!==0},getTimezone:p,dateStr:q,locale2Formats:e=>z(e.localeInfo?.locale,e.localeInfo?.timeZone),year:(e,t)=>t&&e.setFullYear(t)||e.getFullYear(),month:(e,t)=>t&&e.setMonth(v-1)||e.getMonth()+1,date:(e,{year:t,month:s,date:f}={})=>H(e,{FullYear:t,Month:m(s)?s-1:s,Date:f}),hour:(e,t)=>t&&e.setHours(t)||e.getHours(),minutes:(e,t)=>t&&e.setMinutes(t)||e.getMinutes(),seconds:(e,t)=>t&&e.setSeconds(t)||e.getSeconds(),cloneTimeTo:e=>t=>T(e,t),cloneDateTo:e=>t=>g(e,t),time:(e,{hour:t,minutes:s,seconds:f,milliseconds:M}={})=>W(e,{Hours:t,Minutes:s,Seconds:f,Milliseconds:M}),timeStr:e=>(t=!1)=>K(e,t),dateISOStr:e=>r(e),ms:(e,t)=>t&&e.setMilliseconds(t)||e.getMilliseconds(),monthName:e=>x(e,!0),weekDay:e=>x(e),self:e=>e,local:e=>I(e),locale:(e,{locale:t,timeZone:s}={})=>C(e,{locale:t,timeZone:s}),removeLocale:e=>()=>X(e),relocate:e=>({locale:t,timeZone:s}={})=>_(e,t,s),differenceFrom:e=>t=>E({start:e,end:t}),values:e=>t=>a(e,t),ISO:e=>e.toISOString(),daysInMonth:e=>Y(e.getFullYear(),e.getMonth()),isLeapYear:e=>Y(e.getFullYear(),1)===29,format:e=>(...t)=>$(e,...t),addYears:e=>(t=1)=>b(e,`${t} years`),addMonths:e=>(t=1)=>b(e,`${t} months`),addWeeks:e=>(t=1)=>b(e,`${t*7} days`),addDays:e=>(t=1)=>b(e,`${t} days`),nextYear:e=>b(e,"1 year"),nextWeek:e=>b(e,"7 days"),previousWeek:e=>b(e,"subtract, 7 days"),previousYear:e=>b(e,"subtract, 1 year"),nextMonth:e=>b(e,"1 month"),previousMonth:e=>b(e,"subtract, 1 month"),tomorrow:e=>b(e,"1 day"),yesterday:e=>b(e,"subtract, 1 day"),add:e=>(...t)=>b(e,...t),subtract:e=>(...t)=>b(e,...["subtract"].concat([t]).flat())}}var ue=V();function V(){let l=Object.freeze(P(i,h)),S={get:(n,r)=>n[r]?p(n,r):l[r]?.(n),set:(n,r,o)=>l[r]?l[r](n,o):n[r],ownKeys:n=>Object.getOwnPropertyNames(l),has:(n,r)=>r in l||r in n};function u({name:n,fn:r,isMethod:o=!1,proxifyResult:a=!1}={}){if(!n||!r||!(r instanceof Function))return console.error("es-date-fiddler (extendWith): cannot extend without name and/or fn (function)");l=Object.freeze({...l,[n]:c=>(c=i(c),c.localeInfo&&c.relocate(c.localeInfo),o?(...y)=>a?i(r(c,...y)):r(c,...y):a?i(r(c)):r(c))}),console.log(`\u2714 created '${n}' ${o?"method":"getter"}`)}function h(n,r,o=!0){let a=c=>console.error(`invalid locale (time zone: "${c.timeZone}", locale: "${c.locale}"), associated your locale instead`);try{return Intl.DateTimeFormat(n,{timeZone:r}).resolvedOptions()}catch{return o&&a({locale:n,timeZone:r}),Intl.DateTimeFormat().resolvedOptions()}}function m(){return D()}function d({locale:n,timeZone:r}={}){if(!n&&!r)return!1;let o=h(n,r,!1);return n&&!r?o.locale===n:(r&&!n||o.locale===n)&&r===o.timeZone}function i(n){return new Proxy(n,S)}function p(n,r){return r in n&&n[r]instanceof Function?n[r].bind(n):n[r]}function D(n,r){let o=n?.locale||n?.timeZone,a=(n||"")instanceof Date,c=o?new Date:new Date(a?n:Date.parse(n)),y=isNaN(c)?new Date(Date.now()):c,g=i(y);return(o||r)&&(g.locale=o?n:r),g}return Object.defineProperties(D,{now:{get(){return m()}},extendWith:{get(){return u}},validateLocale:{get(){return d}},ownFns:{get(){return Object.getOwnPropertyDescriptors(l)}}}),D}export{V as DateXFactory,ue as default};
