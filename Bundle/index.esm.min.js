var L=re;function re(){let c=Object.entries({year:"FullYear",month:"Month",date:"Date",day:"Date",hour:"Hours",minute:"Minutes",second:"Seconds",millisecond:"Milliseconds"}).reduce((d,[D,g])=>({...d,[D]:g,[`${D}s`]:g}),{}),p=function(...d){if(d.length<1)return[];let D;d[0].startsWith("subtract")&&(D=!0,d[0].startsWith("subtract")&&d.length===1&&(d=d[0].split(",")),d=d.slice(1));let g=d.length===1?d[0]?.split(/,/):d;return g&&g.length&&(d=g.map(y=>y.trim())),d.map(function(y){return y.toLowerCase().split(/\s/).map(m=>(m=m.trim(),parseInt(m)?D?-m:+m:m))})};return function(d,...D){let g=p(...D);return g.length&&g.forEach(([y,m])=>{m=c[m],+y&&m&&d[`set${m}`](d[`get${m}`]()+ +y)}),d}}var U=se;function se(){let c=(D,g)=>{let y=isNaN(D),m=isNaN(g);if(y&&!m){let[M,I,i]=Array(3).fill("start- and/or end date are not valid");return{error:!0,message:M,full:I,clean:i}}if(m){let[M,I,i]=Array(3).fill("end date not valid");return{error:!0,message:M,full:I,clean:i}}if(y){let[M,I,i]=Array(3).fill("start date not valid");return{error:!0,message:M,full:I,clean:i}}return{error:!1}},p=d();return function({start:g,end:y}={}){let m=new Date(Date.parse(g)),M=new Date(Date.parse(y)),I=c(m,M);if(I.error)return I;let i=new Date(g),o=new Date(y),s=Math.abs(o-i),n=new Date(s),u=n.getUTCFullYear()-1970,a=n.getUTCMonth(),l=n.getUTCDate()-1,h=n.getUTCHours(),O=n.getUTCMinutes(),N=n.getUTCSeconds(),w=n.getUTCMilliseconds(),S={from:i,to:o,years:u,months:a,days:l,hours:h,minutes:O,seconds:N,milliseconds:w};return S.full=p({values:S,full:!0}),S.clean=p({values:S}),S};function d(){let D=(...i)=>o=>i.reduce((s,n)=>n(s),o),g=(i,o)=>i===1?o.slice(0,-1):o;return D(({values:i,full:o})=>[Object.entries(i).filter(([s])=>/^(years|month|days|hours|minutes|seconds)/i.test(s)),o],([i,o])=>o?i:i.filter(([,s])=>o?+s:s>0),i=>i.reduce((o,[s,n])=>[...o,`${n} ${g(n,s)}`],[]),i=>i.length<1?"Dates are equal":`${i.slice(0,-1).join(", ")}${i.length>1?" and ":""}${i.slice(-1).shift()}`)}}var fe=W();function W(){let[c,p,d,D]=["2-digit","numeric","long","short"],g={fixed:{MM:{month:d},M:{month:D},m:{month:p},mm:{month:c},yyyy:{year:p},yy:{year:c},WD:{weekday:d},wd:{weekday:D},d:{day:p},dd:{day:c},h:{hour:p},hh:{hour:c},mi:{minute:p},mmi:{minute:c},s:{second:p},ss:{second:c},ms:{fractionalSecondDigits:3},tz:{timeZoneName:"shortOffset"},dl:{locale:"default"},h12:{hour12:!1},yn:{yearName:""},ry:{relatedYear:!0},msp:{fractionalSecond:!0}},dynamic:{tzn:n=>({timeZoneName:n.slice(4)}),hrc:n=>({hourCycle:`h${n.slice(4)}`}),ds:n=>({dateStyle:n.slice(3)}),ts:n=>({timeStyle:n.slice(3)}),tz:n=>({timeZone:n.slice(3)}),e:n=>({era:n.slice(2)}),l:n=>({locale:n.slice(2)})}},y={...g,retrieveDyn(n){let u=n?.slice(0,n.indexOf(":"));return g.dynamic[u]&&g.dynamic[u](n)},get re(){return new RegExp(`\\b(${Object.keys(g.fixed).join("|")})\\b`,"g")}},m=(n="dtf",u=0)=>{let a=` ${n.replace(/(?<=\{)(.+?)(?=})/g,h=>`[${u++}]`).replace(/[{}]/g,"").trim()} `,l=n.match(/(?<=\{)(.+?)(?=})/g)||[];return{get texts(){return l},formatString(h){a=h},set formatStr(h){a=h},get formatStr(){return a},get units(){return a.match(y.re)||[]},finalize(h="",O="",N="",w=""){return a.replace(/~([\d+]?)/g,"$1").replace(/dtf/,h).replace(/era/,N).replace(/dp\b|~dp\b/,O).replace(/yn\b/,w).replace(/\[(\d+?)]/g,(S,F)=>l[F].trim()).trim()}}},M=n=>n.replace(/\s+/g,""),I=(...n)=>n?.reduce((u,a)=>({...u,...y.retrieveDyn(a)||y.fixed[a]}),y.fixed.dl),i=(n,u,a)=>{let l=I(...M(a).split(",")),h=Intl.DateTimeFormat(l.locale,l).format(n);return u.finalize(h)},o=(n,u,a,l)=>n.toLocaleString(u,{timeZone:a,month:l?D:d}),s=(n,u,a)=>{let l=I(...u.units.concat(M(a).split(",")).flat()),h={...y.fixed},O=(w,S)=>l[w]==="numeric"&&S.startsWith("0")?S.slice(1):S,N=Intl.DateTimeFormat(l.locale,l).formatToParts(n).reduce((w,S)=>S.type==="literal"&&/[ ,/-]/.test(S.value)?w:{...w,[S.type]:O(S.type,S.value)},{});return h.ms=l.fractionalSecondDigits?h.msp:h.ms,h.yyyy=N.relatedYear?h.ry:h.yyyy,u.formatStr=u.formatStr.replace(y.re,w=>/^(M|MM)$/.test(w)?o(n,l.locale,l.timeZone,/^M$/.test(w)):N[Object.keys(h[w]).shift()]||w),u.finalize(void 0,N.dayPeriod,N.era,N.yearName)};return(n,u,a="l:default")=>/ds:|ts:/.test(a)?i(n,m(void 0),a):s(n,m(u||void 0),a)}var x=ce;function ce(c,p){let d=W(),D=e=>!(isNaN(parseInt(e))&&isNaN(+e)),g=e=>e?.constructor===Object,y=e=>+e.slice(e.indexOf("+")+1).replace(":","")||0,m=e=>e.localeInfo?.timeZone||Intl.DateTimeFormat().resolvedOptions().timeZone,M=e=>e.map(t=>String(t)?.padStart(2,"0")??t),I=e=>M(u(e)).join("-"),i=e=>Object.entries(e).filter(([,t])=>D(t)),o=e=>console.error(`clone${e?"Time":"Date"}To: no toDate given`),s=(e,t)=>g(t)&&i(t).forEach(([r,f])=>e[`set${r}`](f))&&!0||!1,n=e=>c(e).format("hh,mi,ss,ms").split(",").map(Number),u=e=>c(e).format("yyyy,mm,dd").split(",").map(Number),a=(e,t)=>s(e,t)||n(e),l=(e,t)=>s(e,t)||u(e),h=U(),O=(e,t)=>c(new Date(e,t+1,1,0,0,0)).yesterday.getDate(),N=e=>c(new Date(e)).relocate(e.localeInfo?.locale,e.localeInfo?.timeZone),w=e=>c(new Date(e)).relocate(),S=L(),F=(e,...t)=>c(S(e,...t)),Y=(e,t)=>[`${e&&!(Array.isArray(e)&&e.length<1)?`l:${e}`:""}`,`${t?`tz:${t}`:""}`].filter(r=>r).join(","),q=e=>(delete e.localeInfo,c(e)),E=function(e,t){e=c(e);let{locale:r,timeZone:f}=e.localeInfo;return e.format(t?"MM":"WD",Y(r,f))},G=e=>`.${String(e.getMilliseconds()).padStart(3,"0")}`,_=(e,t)=>e.toLocaleTimeString("en-GB",{timeZone:e.localeInfo?.timeZone})+(t?`${G(e)}`:"");function A(e,{locale:t,timeZone:r,validate:f=!0}={}){return e.localeInfo=t||r?B(e,{locale:t,timeZone:r,validate:f}):e.localeInfo,e.localeInfo}function B(e,{locale:t,timeZone:r}={}){let f=p(t,r);return e.localeInfo={locale:f.locale,timeZone:f.timeZone},e.formats=Y(e.localeInfo.locale,e.localeInfo.timeZone),e.localeInfo}function K(e){e=c(e);let{locale:t,timeZone:r}=e.locale,f=r?{timeZone:r}:{};return e.toLocaleDateString(t,f)}function X(e){let t=m(e),r=new Date(e.getFullYear(),0,1,14),f=new Date(new Date(r).setMonth(6)),b=Intl.DateTimeFormat("en-CA",{year:"numeric",timeZone:t,timeZoneName:"shortOffset"}),[$,T]=[b.format(r),b.format(f)];return y($)-y(T)!==0}function J(e,t,r){return t||r?(A(e,{locale:t,timeZone:r}),c(e)):(e.localeInfo||A(e,p()),c(e))}function Q(e,t){t=c(t??new Date);let r=c(e),{hour:f,minutes:b,seconds:$,ms:T}=r;return t.time={hour:f,minutes:b,seconds:$,ms:T},r.locale?(t.locale={locale:r.locale.locale,timeZone:r.locale.timeZone},t):(o(1),r)}function V(e){e=c(e);let{locale:t,timeZone:r}=e.locale??p();return e.toLocaleString(t,{timeZone:r})}function R(e,...t){e=c(e);let r,f,b;return e.locale&&(r=e.locale.locale,f=e.locale.timeZone,b=e.formats),t.length===1?d(e,t[0],b):t.length?d(e,...t):e.toLocaleString(r||[],f?{timeZone:f}:void 0)}function ee(e,t){t=c(t??new Date);let r=c(e);if(t){let[f,b,$]=r.date;return t.date={year:f,month:b,date:$},r.locale&&(t.locale={locale:r.locale.locale,timeZone:r.locale.timeZone}),t}return o(),r}function k(e){let t={timeZone:m(e),hourCycle:"h23"};try{return c(new Date(new Date(e.toLocaleString("en",t))))}catch(r){return console.error(`Can't retrieve localized date/time value for ${t.timeZone}: ${r.message}`),c(e)}}function j(e){e=c(e);let[t,r]=e.toLocaleString(e.locale.locale,{timeZone:e.locale.timeZone,month:"long",weekday:"long"}).split(" "),[f,b,$,T,Z,z,C,H]=e.format("yyyy,mm,dd,hh,mmi,ss,ms,dp").split(","),oe=e.localeInfo?p(e.localeInfo.locale,e.localeInfo.timeZone):p();return{year:+f,month:+b,date:+$,hour:+T,minutes:+Z,seconds:+z,milliseconds:+C,dayPeriod:H!==""?H:"n/a",monthName:t.normalize(),weekDay:r.normalize(),resolvedLocale:oe,valuesArray:[f,b-1,$,T,Z,z,C].map(Number)}}function te(e){let t=k(e),r=k(new Date(e));r.time=t.time={milliseconds:0};let f=t.differenceFrom(r).clean,b=/equal/.test(f);return`${b?"":+t>=+r?"+":"-"}${b?"no difference":f}`}function ne(e,t){let r=0;for(e=c(e),t=c(t),e.time=t.time={hour:0,minutes:0,seconds:0,milliseconds:0},e>t&&([e,t]=[t,e]);e<t;)e.add("1 day"),r+=1;return r}function P(e,{day:t,next:r=!1,midnight:f=!0,forFirstWeekday:b=!1}={}){e=c(e);let $=e.clone,T=$.getDay();$.time=f?{hour:0,minutes:0,seconds:0,milliseconds:0}:{};let Z="sun,mon,tue,wed,thu,fri,sat".split(",").findIndex(C=>C===t),z=`${r?1:-1} days`;return b&&T===Z?$:Z<0?e:function(){for(T=T===Z?$.add(z).getDay():T;T!==Z;)T=$.add(z).getDay();return $}()}return{clone:N,cloneLocal:w,hasDST:X,dateStr:K,timeZone:e=>m(e),firstWeekday:e=>({sunday:t=!1,midnight:r=!1}={})=>P(e,{day:t?"sun":"mon",midnight:r,forFirstWeekday:!0}),next:e=>(t,{midnight:r=!1}={})=>P(e,{day:t,midnight:r,next:!0}),previous:e=>(t,{midnight:r=!1}={})=>P(e,{day:t,midnight:r}),year:(e,t)=>t&&e.setFullYear(t)||j(e).year,month:(e,t)=>t&&e.setMonth(v-1)||j(e).month,date:(e,{year:t,month:r,date:f}={})=>l(e,{FullYear:t,Month:D(r)?r-1:r,Date:f}),hour:(e,t)=>t&&e.setHours(t)||j(e).hour,minutes:(e,t)=>t&&e.setMinutes(t)||j(e).minutes,seconds:(e,t)=>t&&e.setSeconds(t)||j(e).seconds,cloneTimeTo:e=>t=>Q(e,t),cloneDateTo:e=>t=>ee(e,t),local:e=>V(e),locale:(e,{locale:t,timeZone:r}={})=>A(e,{locale:t,timeZone:r}),removeLocale:e=>q(e),relocate:e=>({locale:t,timeZone:r}={})=>J(e,t,r),timeDiffToHere:e=>te(e),time:(e,{hour:t,minutes:r,seconds:f,milliseconds:b}={})=>a(e,{Hours:t,Minutes:r,Seconds:f,Milliseconds:b}),timeStr:e=>(t=!1)=>_(e,t),dateISOStr:e=>I(e),ms:(e,t)=>t&&e.setMilliseconds(t)||e.getMilliseconds(),monthName:e=>E(e,!0),weekDay:e=>E(e),self:e=>e,differenceFrom:e=>t=>h({start:e,end:t}),values:e=>j(e),ISO:e=>e.toISOString(),daysInMonth:e=>O(e.getFullYear(),e.getMonth()),isLeapYear:e=>O(e.getFullYear(),1)===29,format:e=>(...t)=>R(e,...t),daysUntil:e=>t=>ne(e,t),addYears:e=>(t=1)=>F(e,`${t} years`),addMonths:e=>(t=1)=>F(e,`${t} months`),addWeeks:e=>(t=1)=>F(e,`${t*7} days`),addDays:e=>(t=1)=>F(e,`${t} days`),nextYear:e=>F(e,"1 year"),nextWeek:e=>F(e,"7 days"),previousWeek:e=>F(e,"subtract, 7 days"),previousYear:e=>F(e,"subtract, 1 year"),nextMonth:e=>F(e,"1 month"),previousMonth:e=>F(e,"subtract, 1 month"),tomorrow:e=>F(e,"1 day"),yesterday:e=>F(e,"subtract, 1 day"),add:e=>(...t)=>F(e,...t),subtract:e=>(...t)=>F(e,...["subtract"].concat([t]).flat())}}var be=ae();function ae(){let c=x(m,D),p={get:(o,s)=>o[s]?M(o,s):c[s]?.(o),set:(o,s,n)=>c[s]?c[s](o,n):o[s],ownKeys:()=>Object.getOwnPropertyNames(c),has:(o,s)=>s in c||s in o};function d({name:o,fn:s,root:n,isMethod:u,proxifyResult:a}={}){if(!o||!s||!(s instanceof Function))return console.error("es-date-fiddler (extendWith): cannot extend without name and/or fn (function)");if(n)return Object.defineProperty(i,o,{value:(...l)=>{let h=s(...l);return h instanceof Date?m(h):h}}),console.log(`\u2714 created '${o}' root level method`);c=Object.freeze({...c,[o]:l=>(l=m(l),l.localeInfo&&l.relocate(l.localeInfo),u?(...h)=>a?m(s(l,...h)):s(l,...h):a?m(s(l)):s(l))}),console.log(`\u2714 created '${o}' ${u?"method":"getter"}`)}function D(o,s,n=!0){let u=a=>console.error(`invalid locale (time zone: "${a.timeZone}", locale: "${a.locale}"), associated your locale instead`);try{return Intl.DateTimeFormat(o,{timeZone:s}).resolvedOptions()}catch{return n&&u({locale:o,timeZone:s}),Intl.DateTimeFormat().resolvedOptions()}}function g(){return i()}function y({locale:o,timeZone:s}={}){if(!o&&!s)return!1;let n=D(o,s,!1);return o&&!s?n.locale===o:(s&&!o||n.locale===o)&&s===n.timeZone}function m(o){return new Proxy(o,p)}function M(o,s){return s in o&&o[s]instanceof Function?o[s].bind(o):o[s]}function I(){let o={mgm:"mutating getter method",c:"chainable",g:"getter",s:"setter",mg:"mutating getter",gm:"getter method"},s={};return Object.entries(Object.getOwnPropertyDescriptors(c)).sort(([n],[u])=>n.localeCompare(u)).forEach(([n,u])=>{let a=String(u.value).match(/(?<=\/\*).+?(?=\*\/)/)?.shift()?.split(",")?.map(l=>o[l]).join(", ");a&&(s[n]=a)}),Object.keys(s).length<1?(console.error("$D.describe can only be used with uncompressed code"),{}):s}function i(o,s){o=Array.isArray(o)?new Date(...o):o;let n=o?.locale||o?.timeZone,u=(o||"")instanceof Date,a=n?new Date:new Date(u?o:Date.parse(o)),l=isNaN(a)?new Date(Date.now()):a;return m(l).relocate(n?o:s)}return Object.defineProperties(i,{now:{get(){return g()}},extendWith:{get(){return d}},validateLocale:{get(){return y}},ownFns:{get(){return Object.getOwnPropertyDescriptors(c)}},describe:{get(){return I()}}}),i}export{ae as DateXFactory,be as default};
