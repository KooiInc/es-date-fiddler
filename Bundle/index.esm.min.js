var z=J;function J(){let c=Object.entries({year:"FullYear",month:"Month",date:"Date",day:"Date",hour:"Hours",minute:"Minutes",second:"Seconds",millisecond:"Milliseconds"}).reduce((l,[h,g])=>({...l,[h]:g,[`${h}s`]:g}),{}),S=function(...l){if(l.length<1)return[];let h;l[0].startsWith("subtract")&&(h=!0,l[0].startsWith("subtract")&&l.length===1&&(l=l[0].split(",")),l=l.slice(1));let g=l.length===1?l[0]?.split(/,/):l;return g&&g.length&&(l=g.map(i=>i.trim())),l.map(function(i){return i.toLowerCase().split(/\s/).map(f=>(f=f.trim(),parseInt(f)?h?-f:+f:f))})};return function(l,...h){let g=S(...h);return g.length&&g.forEach(([i,f])=>{f=c[f],+i&&f&&l[`set${f}`](l[`get${f}`]()+ +i)}),l}}var A=Q;function Q(){let c=(h,g)=>{let i=isNaN(h),f=isNaN(g);if(i&&!f){let[D,a,o]=Array(3).fill("start- and/or end date are not valid");return{error:!0,message:D,full:a,clean:o}}if(f){let[D,a,o]=Array(3).fill("end date not valid");return{error:!0,message:D,full:a,clean:o}}if(i){let[D,a,o]=Array(3).fill("start date not valid");return{error:!0,message:D,full:a,clean:o}}return{error:!1}},S=l();return function({start:g,end:i}={}){let f=new Date(Date.parse(g)),D=new Date(Date.parse(i)),a=c(f,D);if(a.error)return a;let o=new Date(g),m=new Date(i),r=Math.abs(m-o),s=new Date(r),d=s.getUTCFullYear()-1970,p=s.getUTCMonth(),y=s.getUTCDate()-1,O=s.getUTCHours(),I=s.getUTCMinutes(),F=s.getUTCSeconds(),M=s.getUTCMilliseconds(),T={from:o,to:m,years:d,months:p,days:y,hours:O,minutes:I,seconds:F,milliseconds:M};return T.full=S({values:T,full:!0}),T.clean=S({values:T}),T};function l(){let h=(...o)=>m=>o.reduce((r,s)=>s(r),m),g=(o,m)=>o===1?m.slice(0,-1):m;return h(({values:o,full:m})=>[Object.entries(o).filter(([r])=>/^(years|month|days|hours|minutes|seconds)/i.test(r)),m],([o,m])=>m?o:o.filter(([,r])=>m?+r:r>0),o=>o.reduce((m,[r,s])=>[...m,`${s} ${g(s,r)}`],[]),o=>o.length<1?"Dates are equal":`${o.slice(0,-1).join(", ")}${o.length>1?" and ":""}${o.slice(-1).shift()}`)}}var ae=w();function w(){let[c,S,l,h]=["2-digit","numeric","long","short"],g={fixed:{MM:{month:l},M:{month:h},m:{month:S},mm:{month:c},yyyy:{year:S},yy:{year:c},WD:{weekday:l},wd:{weekday:h},d:{day:S},dd:{day:c},h:{hour:S},hh:{hour:c},mi:{minute:S},mmi:{minute:c},s:{second:S},ss:{second:c},ms:{fractionalSecondDigits:3},tz:{timeZoneName:"shortOffset"},dl:{locale:"default"},h12:{hour12:!1},yn:{yearName:""},ry:{relatedYear:!0},msp:{fractionalSecond:!0}},dynamic:{tzn:r=>({timeZoneName:r.slice(4)}),hrc:r=>({hourCycle:`h${r.slice(4)}`}),ds:r=>({dateStyle:r.slice(3)}),ts:r=>({timeStyle:r.slice(3)}),tz:r=>({timeZone:r.slice(3)}),e:r=>({era:r.slice(2)}),l:r=>({locale:r.slice(2)})}},i={...g,retrieveDyn(r){let s=r?.slice(0,r.indexOf(":"));return g.dynamic[s]&&g.dynamic[s](r)},get re(){return new RegExp(`\\b(${Object.keys(g.fixed).join("|")})\\b`,"g")}},f=(r="dtf",s=0)=>{let d=` ${r.replace(/(?<=\{)(.+?)(?=})/g,y=>`[${s++}]`).replace(/[{}]/g,"").trim()} `,p=r.match(/(?<=\{)(.+?)(?=})/g)||[];return{get texts(){return p},formatString(y){d=y},set formatStr(y){d=y},get formatStr(){return d},get units(){return d.match(i.re)||[]},finalize(y="",O="",I="",F=""){return d.replace(/~([\d+]?)/g,"$1").replace(/dtf/,y).replace(/era/,I).replace(/dp\b|~dp\b/,O).replace(/yn\b/,F).replace(/\[(\d+?)]/g,(M,T)=>p[T].trim()).trim()}}},D=r=>r.replace(/\s+/g,""),a=(...r)=>r?.reduce((s,d)=>({...s,...i.retrieveDyn(d)||i.fixed[d]}),i.fixed.dl),o=(r,s,d)=>{let p=a(...D(d).split(",")),y=Intl.DateTimeFormat(p.locale,p).format(r);return s.finalize(y)},m=(r,s,d)=>{let p=a(...s.units.concat(D(d).split(",")).flat()),y={...i.fixed},O=(F,M)=>p[F]==="numeric"&&M.startsWith("0")?M.slice(1):M,I=Intl.DateTimeFormat(p.locale,p).formatToParts(r).reduce((F,M)=>M.type==="literal"?F:{...F,[M.type]:O(M.type,M.value)},{});return y.ms=p.fractionalSecondDigits?y.msp:y.ms,y.yyyy=I.relatedYear?y.ry:y.yyyy,s.formatStr=s.formatStr.replace(i.re,F=>I[Object.keys(y[F]).shift()]||F),s.finalize(void 0,I.dayPeriod,I.era,I.yearName)};return(r,s,d="l:default")=>/ds:|ts:/.test(d)?o(r,f(void 0),d):m(r,f(s||void 0),d)}var L=V;function V(c){let S=!0,l=w(),h=e=>!(isNaN(parseInt(e))&&isNaN(+e)),g=e=>e?.constructor===Object,i=e=>+e.slice(e.indexOf("+")+1).replace(":","")||0,f=e=>e.localeInfo?.timeZone||Intl.DateTimeFormat().resolvedOptions().timeZone,D=(e,t=2)=>`${e}`.padStart(t,"0"),a=e=>e.map(t=>String(t)?.padStart(2,"0")??t),o=e=>a(T(e)).join("-"),m=e=>Object.entries(e).filter(([,t])=>h(t)),r=(e,t)=>{let n={year:e.getFullYear(),month:e.getMonth()+1,date:e.getDate(),hour:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds(),milliseconds:e.getMilliseconds()};return t?Object.values(n):n},s=e=>{let t={timeZone:f(e),hourCycle:"h23"},n;try{return c(new Date(new Date(e.toLocaleString("en",t))))}catch(u){return console.error(`Can't retrieve localized date/time value for ${t.timeZone}: ${u.message}`),c(e)}},d=e=>console.error(`clone${e?"Time":"Date"}To: no toDate given`),p=(e,t)=>{t=c(t??new Date);let n=c(e);if(t){let[u,$,N]=n.date;return t.date={year:u,month:$,date:N},n.locale&&(t.locale={locale:n.locale.locale,timeZone:n.locale.timeZone}),t}return d(),n},y=(e,t)=>{t=c(t??new Date);let n=c(e),{hour:u,minutes:$,seconds:N,ms:Z}=n;return t.time={hour:u,minutes:$,seconds:N,ms:Z},n.locale?(t.locale={locale:n.locale.locale,timeZone:n.locale.timeZone},t):(d(1),n)},O=e=>{e=c(e);let t={};if(!e.locale)return e.toLocaleString();let{locale:n,timeZone:u}=e.locale;return e.locale?.timeZone&&(t={timeZone:e.locale.timeZone}),e.toLocaleString(n,t)},I=(e,...t)=>{e=c(e);let n,u,$;return e.locale&&(n=e.locale.locale,u=e.locale.timeZone,$=e.formats),t.length===1?l(e,t[0],$):t.length?l(e,...t):e.toLocaleString(n||[],u?{timeZone:u}:void 0)},F=(e,t)=>g(t)&&m(t).forEach(([n,u])=>e[`set${n}`](u))&&!0||!1,M=e=>[e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()??0],T=e=>[e.getFullYear(),e.getMonth()+1,e.getDate()],W=(e,t)=>F(e,t)||M(e),P=(e,t)=>F(e,t)||T(e),H=A(),Y=(e,t)=>c(new Date(e,t+1,1,0,0,0)).yesterday.getDate(),ee=e=>[e.getFullYear(),e.getMonth(),e.getDate()],E=e=>c(new Date(e)).relocate(e.localeInfo),U=z(),b=(e,...t)=>c(U(e,...t)),k=e=>console.error(`invalid locale (time zone: "${e.timeZone}", locale: "${e.locale}"), associated your locale instead`),j=(e,t,n=!0)=>{try{return Intl.DateTimeFormat(e,{timeZone:t}).resolvedOptions()}catch{return n&&k({locale:e,timeZone:t}),Intl.DateTimeFormat().resolvedOptions()}},X=(e,t)=>[`${e&&!(Array.isArray(e)&&e.length<1)?`l:${e}`:""}`,`${t?`tz:${t}`:""}`].filter(n=>n).join(","),_=function(e,{locale:t,timeZone:n}={}){if(t||n){let u=j(t||[],n);e.localeInfo={locale:u?.locale||navigator?.language||"en",timeZone:u?.timeZone||Intl.DateTimeFormat().resolvedOptions().timeZone},e.formats=X(e.localeInfo.locale,e.localeInfo.timeZone)}return e.localeInfo??void 0},C=(e,{locale:t,timeZone:n,validate:u=!0}={})=>((t||n)&&(e.localeInfo=_(e,{locale:t,timeZone:n,validate:u})),e.localeInfo),q=e=>(delete e.localeInfo,c(e)),G=function(e,t,n,u){return(t||n)&&C(e,{locale:t,timeZone:n}),c(e)},x=function(e,t){return e=c(e),e.format(t?"MM":"WD",`l:${e.locale?.locale||"utc"}`)},K=e=>{let t={};if(e=c(e),!e.locale)return e.toLocaleDateString();let{locale:n,timeZone:u}=e.locale;return e.locale?.timeZone&&(t={timeZone:e.locale.timeZone}),e.toLocaleDateString(n,t)},B=(e,t)=>{let n=M(e).reduce((u,$,N)=>[...u,N<3?D($):D($,3)],[]);return`${n.slice(0,3).join(":")}${t?`.${n.slice(-1)}`:""}`};return{clone:E,localizedDT:s,hasDST:e=>{let t=f(e),n=new Date(e.getFullYear(),0,1,14),u=new Date(new Date(n).setMonth(6)),$=Intl.DateTimeFormat("en-CA",{year:"numeric",timeZone:t,timeZoneName:"shortOffset"}),[N,Z]=[$.format(n),$.format(u)];return i(N)-i(Z)!==0},getTimezone:f,dateStr:K,localeValidator:()=>({locale:e,timeZone:t}={})=>{if(!e&&!t)return!1;let n=j(e,t,!1);return e&&!t?n.locale===e:(t&&!e||n.locale===e)&&t===n.timeZone},year:(e,t)=>t&&e.setFullYear(t)||e.getFullYear(),month:(e,t)=>t&&e.setMonth(v-1)||e.getMonth()+1,date:(e,{year:t,month:n,date:u}={})=>P(e,{FullYear:t,Month:h(n)?n-1:n,Date:u}),hour:(e,t)=>t&&e.setHours(t)||e.getHours(),minutes:(e,t)=>t&&e.setMinutes(t)||e.getMinutes(),seconds:(e,t)=>t&&e.setSeconds(t)||e.getSeconds(),cloneTimeTo:e=>t=>y(e,t),cloneDateTo:e=>t=>p(e,t),time:(e,{hour:t,minutes:n,seconds:u,milliseconds:$}={})=>W(e,{Hours:t,Minutes:n,Seconds:u,Milliseconds:$}),timeStr:e=>(t=!1)=>B(e,t),dateISOStr:e=>o(e),ms:(e,t)=>t&&e.setMilliseconds(t)||e.getMilliseconds(),monthName:e=>x(e,!0),weekDay:e=>x(e),self:e=>e,local:e=>O(e),locale:(e,{locale:t,timeZone:n}={})=>C(e,{locale:t,timeZone:n}),removeLocale:e=>()=>q(e),relocate:e=>({locale:t,timeZone:n}={})=>G(e,t,n),differenceFrom:e=>t=>H({start:e,end:t}),values:e=>t=>r(e,t),ISO:e=>e.toISOString(),daysInMonth:e=>Y(e.getFullYear(),e.getMonth()),isLeapYear:e=>Y(e.getFullYear(),1)===29,format:e=>(...t)=>I(e,...t),addYears:e=>(t=1)=>b(e,`${t} years`),addMonths:e=>(t=1)=>b(e,`${t} months`),addWeeks:e=>(t=1)=>b(e,`${t*7} days`),addDays:e=>(t=1)=>b(e,`${t} days`),nextYear:e=>b(e,"1 year"),nextWeek:e=>b(e,"7 days"),previousWeek:e=>b(e,"subtract, 7 days"),previousYear:e=>b(e,"subtract, 1 year"),nextMonth:e=>b(e,"1 month"),previousMonth:e=>b(e,"subtract, 1 month"),tomorrow:e=>b(e,"1 day"),yesterday:e=>b(e,"subtract, 1 day"),add:e=>(...t)=>b(e,...t),subtract:e=>(...t)=>b(e,...["subtract"].concat([t]).flat())}}var me=R();function R(){let c=L(i),S={get:(a,o)=>a[o]?f(a,o):c[o]?.(a),set:(a,o,m)=>c[o]?c[o](a,m):a[o],ownKeys:a=>Object.getOwnPropertyNames(c),has:(a,o)=>o in c||o in a};function l({name:a,fn:o,isMethod:m=!1,proxifyResult:r=!1}={}){if(!a||!o||!(o instanceof Function))return console.error("es-date-fiddler (extendWith): cannot extend without name and/or fn (function)");c[a]=s=>(s=i(s),s.localeInfo&&s.relocate(s.localeInfo),m?(...d)=>r?i(o(s,...d)):o(s,...d):r?i(o(s)):o(s))}function h(){return D()}function g({locale:a,timeZone:o}={}){return D().localeValidator({locale:a,timeZone:o})}function i(a){return new Proxy(a,S)}function f(a,o){return o in a&&a[o]instanceof Function?a[o].bind(a):a[o]}function D(a,o){let m=a?.locale||a?.timeZone,r=(a||"")instanceof Date,s=m?new Date:new Date(r?a:Date.parse(a)),d=isNaN(s)?new Date(Date.now()):s,p=i(d);return(m||o)&&(p.locale=m?a:o),p}return Object.defineProperties(D,{now:{get(){return h()}},extendWith:{get(){return l}},validateLocale:{get(){return g}}}),D}export{R as DateXFactory,me as default};
