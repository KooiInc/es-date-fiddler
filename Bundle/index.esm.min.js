var N=j;function j(){let d=Object.entries({year:"FullYear",month:"Month",date:"Date",day:"Date",hour:"Hours",minute:"Minutes",second:"Seconds",millisecond:"Milliseconds"}).reduce((c,[o,r])=>({...c,[o]:r,[`${o}s`]:r}),{}),h=function(...c){if(c.length<1)return[];let o;(c[0]==="subtract"||c[0].startsWith("subtract"))&&(o=!0,c[0].startsWith("subtract")&&c.length===1&&(c=c[0].split(",")),c=c.slice(1));let r=c.length===1?c[0]?.split(/,/):c;return r&&r.length&&(c=r.map(u=>u.trim())),c.map(function(u){return u.toLowerCase().split(/\s/).map(i=>(i=i.trim(),+i?o?-i:+i:i))})};return function(c,...o){let r=h(...o);return r.length&&r.forEach(([u,i])=>{i=d[i],+u&&i&&c[`set${i}`](c[`get${i}`]()+ +u)}),c}}var w=H;function H(){let d=(c,o)=>{let r=isNaN(c),u=isNaN(o);if(r&&!u){let[i,D,s]=Array(3).fill("start and end date are not valid");return{error:!0,message:i,full:D,clean:s}}if(u){let[i,D,s]=Array(3).fill("end date not valid");return{error:!0,message:i,full:D,clean:s}}if(r){let[i,D,s]=Array(3).fill("start date not valid");return{error:!0,message:i,full:D,clean:s}}return{error:!1}},h=F();return function({start:o,end:r}={}){let u=new Date(Date.parse(o)),i=new Date(Date.parse(r)),D=d(u,i);if(D.error)return D;let s=new Date(o),g=new Date(r),n=Math.abs(g-s),a=new Date(n),m=a.getUTCFullYear()-1970,p=a.getUTCMonth(),f=a.getUTCDate()-1,$=a.getUTCHours(),l=a.getUTCMinutes(),M=a.getUTCSeconds(),S=a.getUTCMilliseconds(),b={years:m,months:p,days:f,hours:$,minutes:l,seconds:M,milliseconds:S};return b.full=h({values:b,full:!0}),b.clean=h({values:b}),b};function F(){let c=(...s)=>g=>s.reduce((n,a)=>a(n),g),o=(s,g)=>s===1?g.slice(0,-1):g;return c(({values:s,full:g})=>[Object.entries(s).filter(([n])=>/^(years|month|days|hours|minutes|seconds)/i.test(n)),g],([s,g])=>g?s:s.filter(([,n])=>g?+n:n>0),s=>s.reduce((g,[n,a])=>[...g,`${a} ${o(a,n)}`],[]),s=>s.length<1?"Dates are equal":`${s.slice(0,-1).join(", ")}${s.length>1?" and ":""}${s.slice(-1).shift()}`)}}var L=I();function I(){let[d,h,F,c]=["2-digit","numeric","long","short"],o={fixed:{MM:{month:F},M:{month:c},m:{month:h},mm:{month:d},yyyy:{year:h},yy:{year:d},WD:{weekday:F},wd:{weekday:c},d:{day:h},dd:{day:d},h:{hour:h},hh:{hour:d},mi:{minute:h},mmi:{minute:d},s:{second:h},ss:{second:d},ms:{fractionalSecondDigits:3},tz:{timeZoneName:"shortOffset"},dl:{locale:"default"},h12:{hour12:!1},yn:{yearName:""},ry:{relatedYear:!0},msp:{fractionalSecond:!0}},dynamic:{tzn:n=>({timeZoneName:n.slice(4)}),hrc:n=>({hourCycle:`h${n.slice(4)}`}),ds:n=>({dateStyle:n.slice(3)}),ts:n=>({timeStyle:n.slice(3)}),tz:n=>({timeZone:n.slice(3)}),e:n=>({era:n.slice(2)}),l:n=>({locale:n.slice(2)})}},r={...o,retrieveDyn(n){let a=n?.slice(0,n.indexOf(":"));return o.dynamic[a]&&o.dynamic[a](n)},get re(){return new RegExp(`\\b(${Object.keys(o.fixed).join("|")})\\b`,"g")}},u=(n="dtf",a=0)=>{let m=` ${n.replace(/(?<=\{)(.+?)(?=})/g,f=>`[${a++}]`).replace(/[{}]/g,"").trim()} `,p=n.match(/(?<=\{)(.+?)(?=})/g)||[];return{get texts(){return p},formatString(f){m=f},set formatStr(f){m=f},get formatStr(){return m},get units(){return m.match(r.re)||[]},finalize(f="",$="",l="",M=""){return m.replace(/~([\d+]?)/g,"$1").replace(/dtf/,f).replace(/era/,l).replace(/dp\b|~dp\b/,$).replace(/yn\b/,M).replace(/\[(\d+?)]/g,(S,b)=>p[b].trim()).trim()}}},i=n=>n.replace(/\s+/g,""),D=(...n)=>n?.reduce((a,m)=>({...a,...r.retrieveDyn(m)||r.fixed[m]}),r.fixed.dl),s=(n,a,m)=>{let p=D(...i(m).split(",")),f=Intl.DateTimeFormat(p.locale,p).format(n);return a.finalize(f)},g=(n,a,m)=>{let p=D(...a.units.concat(i(m).split(",")).flat()),f={...r.fixed},$=(M,S)=>p[M]==="numeric"&&S.startsWith("0")?S.slice(1):S,l=Intl.DateTimeFormat(p.locale,p).formatToParts(n).reduce((M,S)=>S.type==="literal"?M:{...M,[S.type]:$(S.type,S.value)},{});return f.ms=p.fractionalSecondDigits?f.msp:f.ms,f.yyyy=l.relatedYear?f.ry:f.yyyy,a.formatStr=a.formatStr.replace(r.re,M=>l[Object.keys(f[M]).shift()]||M),a.finalize(void 0,l.dayPeriod,l.era,l.yearName)};return(n,a,m="l:default")=>/ds:|ts:/.test(m)?s(n,u(void 0),m):g(n,u(a||void 0),m)}var U=P;function P(d){let h=I(),F=(t,e)=>{let y={year:t.getFullYear(),month:t.getMonth()+1,date:t.getDate(),hour:t.getHours(),minutes:t.getMinutes(),seconds:t.getSeconds(),milliseconds:t.getMilliseconds()};return e?Object.values(y):y},c=(t,e)=>(e&&(t.localeInfo=M(t,e)),t.localeInfo),o=(t,e)=>{let y=new Date(...p(e??new Date)),T=s(t,!0);return f(new Date(...p(y).concat(T)))},r=(t,e)=>(t=d(t),t.locale?(t.locale?.tz&&(e={...e??{},timeZone:t.locale.tz}),t.toLocaleString(t.locale.l,e)):t.toLocaleString()),u=(t,...e)=>{let y=d(t).locale;return e.length===1?h(t,e[0],y?.formats):e.length?h(t,...e):t.toLocaleString(y?.l)},i=(t,{year:e,month:y,date:T}={})=>{let[x,C,Y]=g(t);t.setFullYear(e||x),t.setMonth((y||C+1)-1),t.setDate(T||Y)},D=w(),s=t=>[t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()],g=t=>[t.getFullYear(),t.getMonth(),t.getDate()],n=(t,e)=>{let y=s(t),T=e?`.${y.pop()}`.padStart(3,"0"):"";return`${y.slice(0,3).map(x=>`${x}`.padStart(2,"0")).join(":")}${T}`},a=function(t,{hour:e,minutes:y,seconds:T,milliseconds:x}={}){let[C,Y,z,O]=s(t);t.setHours(e??C),t.setMinutes(y??Y),t.setSeconds(T??z),t.setMilliseconds(x??O)},m=(t,e)=>d(new Date(t,e+1,1,0,0,0)).yesterday.getDate(),p=t=>[t.getFullYear(),t.getMonth(),t.getDate()],f=t=>d(new Date(t)),$=N(),l=(t,...e)=>d($(t,...e)),M=function(t,{locale:e="utc",timeZone:y="Etc/UTC"}={}){return t.localeInfo={l:e,tz:y,formats:`l:${e},tz:${y}`},t.localeInfo};return{...{clone:f,year:(t,e)=>e&&t.setFullYear(e)||t.getFullYear(),month:(t,e)=>e&&t.setMonth(e-1)||t.getMonth()+1,date:(t,e)=>e&&i(t,e)||t.getDate(t),hour:(t,e)=>e&&t.setHours(e)||t.getHours(),minutes:(t,e)=>e&&t.setMinutes(e)||t.getMinutes(),seconds:(t,e)=>e&&t.setSeconds(e)||t.getSeconds(),cloneDate:t=>f(new Date(...p(t).concat([0,0,0]))),cloneTime:t=>o(t),cloneTimeTo:t=>e=>o(t,e),time:(t,e)=>e&&a(t,e)||s(t),timeStr:t=>(e=!1)=>n(t,e),ms:(t,e)=>e&&t.setMilliseconds(e)||t.getMilliseconds(),monthName:t=>(t=d(t),t.format("MM",`l:${t.locale?.l||"utc"}`)),weekDay:t=>(t=d(t),t.format("WD",`l:${t.locale?.l||"utc"}`)),self:t=>t,local:(t,e)=>r(t,e),locale:(t,e)=>c(t,e),differenceFrom:t=>e=>D({start:t,end:e}),values:t=>e=>F(t,e),UTC:t=>Date.UTC(...F(t,!0)),UTCString:t=>t.toUTCString(),ISO:t=>t.toISOString(),daysInMonth:t=>m(t.getFullYear(),t.getMonth()),isLeapYear:t=>m(t.getFullYear(),1)===29,format:t=>(...e)=>u(t,...e)},...{addYears:t=>(e=1)=>l(t,`${e} years`),addMonths:t=>(e=1)=>l(t,`${e} months`),addWeeks:t=>(e=1)=>l(t,`${e*7} days`),addDays:t=>(e=1)=>l(t,`${e} days`),nextYear:t=>l(t,"1 year"),nextWeek:t=>l(t,"7 days"),previousWeek:t=>l(t,"subtract, 7 days"),previousYear:t=>l(t,"subtract, 1 year"),nextMonth:t=>l(t,"1 month"),previousMonth:t=>l(t,"subtract, 1 month"),tomorrow:t=>l(t,"1 day"),yesterday:t=>l(t,"subtract, 1 day"),add:t=>(...e)=>l(t,...e),subtract:t=>(...e)=>l(t,...["subtract"].concat([e]).flat())}}}var B=W();function W(){let d=U(F),h={get:(o,r)=>!o[r]&&d[r]?.(o)||c(o,r),set:(o,r,u)=>d[r]?.(o,u)||o[r]};return function(o,r){let u=o?.locale||o?.timeZone,i=u?new Date:new Date(Date.parse(o)),D=isNaN(i)?new Date(Date.now()):i,s=F(D);return(u||r)&&(s.locale=u?o:r),s};function F(o){return new Proxy(o,h)}function c(o,r){return r in o&&o[r]instanceof Function?o[r].bind(o):o[r]}}export{W as DateFiddlerFactory,B as default};
