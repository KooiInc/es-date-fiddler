var w=P;function P(){let l=Object.entries({year:"FullYear",month:"Month",date:"Date",day:"Date",hour:"Hours",minute:"Minutes",second:"Seconds",millisecond:"Milliseconds"}).reduce((a,[g,u])=>({...a,[g]:u,[`${g}s`]:u}),{}),p=function(...a){if(a.length<1)return[];let g;a[0].startsWith("subtract")&&(g=!0,a[0].startsWith("subtract")&&a.length===1&&(a=a[0].split(",")),a=a.slice(1));let u=a.length===1?a[0]?.split(/,/):a;return u&&u.length&&(a=u.map(n=>n.trim())),a.map(function(n){return n.toLowerCase().split(/\s/).map(r=>(r=r.trim(),+r?g?-r:+r:r))})};return function(a,...g){let u=p(...g);return u.length&&u.forEach(([n,r])=>{r=l[r],+n&&r&&a[`set${r}`](a[`get${r}`]()+ +n)}),a}}var Z=E;function E(){let l=(g,u)=>{let n=isNaN(g),r=isNaN(u);if(n&&!r){let[m,h,s]=Array(3).fill("start- and/or end date are not valid");return{error:!0,message:m,full:h,clean:s}}if(r){let[m,h,s]=Array(3).fill("end date not valid");return{error:!0,message:m,full:h,clean:s}}if(n){let[m,h,s]=Array(3).fill("start date not valid");return{error:!0,message:m,full:h,clean:s}}return{error:!1}},p=a();return function({start:u,end:n}={}){let r=new Date(Date.parse(u)),m=new Date(Date.parse(n)),h=l(r,m);if(h.error)return h;let s=new Date(u),f=new Date(n),c=Math.abs(f-s),i=new Date(c),d=i.getUTCFullYear()-1970,S=i.getUTCMonth(),y=i.getUTCDate()-1,N=i.getUTCHours(),b=i.getUTCMinutes(),M=i.getUTCSeconds(),$=i.getUTCMilliseconds(),T={from:s,to:f,years:d,months:S,days:y,hours:N,minutes:b,seconds:M,milliseconds:$};return T.full=p({values:T,full:!0}),T.clean=p({values:T}),T};function a(){let g=(...s)=>f=>s.reduce((c,i)=>i(c),f),u=(s,f)=>s===1?f.slice(0,-1):f;return g(({values:s,full:f})=>[Object.entries(s).filter(([c])=>/^(years|month|days|hours|minutes|seconds)/i.test(c)),f],([s,f])=>f?s:s.filter(([,c])=>f?+c:c>0),s=>s.reduce((f,[c,i])=>[...f,`${i} ${u(i,c)}`],[]),s=>s.length<1?"Dates are equal":`${s.slice(0,-1).join(", ")}${s.length>1?" and ":""}${s.slice(-1).shift()}`)}}var q=Y();function Y(){let[l,p,a,g]=["2-digit","numeric","long","short"],u={fixed:{MM:{month:a},M:{month:g},m:{month:p},mm:{month:l},yyyy:{year:p},yy:{year:l},WD:{weekday:a},wd:{weekday:g},d:{day:p},dd:{day:l},h:{hour:p},hh:{hour:l},mi:{minute:p},mmi:{minute:l},s:{second:p},ss:{second:l},ms:{fractionalSecondDigits:3},tz:{timeZoneName:"shortOffset"},dl:{locale:"default"},h12:{hour12:!1},yn:{yearName:""},ry:{relatedYear:!0},msp:{fractionalSecond:!0}},dynamic:{tzn:c=>({timeZoneName:c.slice(4)}),hrc:c=>({hourCycle:`h${c.slice(4)}`}),ds:c=>({dateStyle:c.slice(3)}),ts:c=>({timeStyle:c.slice(3)}),tz:c=>({timeZone:c.slice(3)}),e:c=>({era:c.slice(2)}),l:c=>({locale:c.slice(2)})}},n={...u,retrieveDyn(c){let i=c?.slice(0,c.indexOf(":"));return u.dynamic[i]&&u.dynamic[i](c)},get re(){return new RegExp(`\\b(${Object.keys(u.fixed).join("|")})\\b`,"g")}},r=(c="dtf",i=0)=>{let d=` ${c.replace(/(?<=\{)(.+?)(?=})/g,y=>`[${i++}]`).replace(/[{}]/g,"").trim()} `,S=c.match(/(?<=\{)(.+?)(?=})/g)||[];return{get texts(){return S},formatString(y){d=y},set formatStr(y){d=y},get formatStr(){return d},get units(){return d.match(n.re)||[]},finalize(y="",N="",b="",M=""){return d.replace(/~([\d+]?)/g,"$1").replace(/dtf/,y).replace(/era/,b).replace(/dp\b|~dp\b/,N).replace(/yn\b/,M).replace(/\[(\d+?)]/g,($,T)=>S[T].trim()).trim()}}},m=c=>c.replace(/\s+/g,""),h=(...c)=>c?.reduce((i,d)=>({...i,...n.retrieveDyn(d)||n.fixed[d]}),n.fixed.dl),s=(c,i,d)=>{let S=h(...m(d).split(",")),y=Intl.DateTimeFormat(S.locale,S).format(c);return i.finalize(y)},f=(c,i,d)=>{let S=h(...i.units.concat(m(d).split(",")).flat()),y={...n.fixed},N=(M,$)=>S[M]==="numeric"&&$.startsWith("0")?$.slice(1):$,b=Intl.DateTimeFormat(S.locale,S).formatToParts(c).reduce((M,$)=>$.type==="literal"?M:{...M,[$.type]:N($.type,$.value)},{});return y.ms=S.fractionalSecondDigits?y.msp:y.ms,y.yyyy=b.relatedYear?y.ry:y.yyyy,i.formatStr=i.formatStr.replace(n.re,M=>b[Object.keys(y[M]).shift()]||M),i.finalize(void 0,b.dayPeriod,b.era,b.yearName)};return(c,i,d="l:default")=>/ds:|ts:/.test(d)?s(c,r(void 0),d):f(c,r(i||void 0),d)}var x=U;function U(l){let p=Y(),a=(e,t)=>{let o={year:e.getFullYear(),month:e.getMonth()+1,date:e.getDate(),hour:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds(),milliseconds:e.getMilliseconds()};return t?Object.values(o):o},g=(e,{locale:t,timeZone:o}={})=>((t||o)&&(e.localeInfo=A(e,{locale:t,timeZone:o})),e.localeInfo),u=e=>t=>new Date(new Date().toLocaleString("en",{timeZone:t})).toLocaleString("en-CA",{hourCycle:"h23"}),n=(e,t)=>{t=l(t??new Date);let o=l(e);if(t){let{year:D,month:I,date:O}=o;t.date={year:D,month:I,date:O},o.locale&&(t.locale={locale:o.locale.locale,timeZone:o.locale.timeZone})}return t},r=(e,t)=>{t=l(t??new Date);let o=l(e),{hour:D,minutes:I,seconds:O,ms:H}=o;return t.time={hour:D,minutes:I,seconds:O,ms:H},o.locale&&(t.locale={locale:o.locale.locale,timeZone:o.locale.timeZone}),t},m=function(e){let o=j(e)?.replace(/l:/,"locale: ").replace(/tz:/,"timeZone: ");return e.toLocaleString()+` !!invalid locale info => ${o}`},h=e=>{e=l(e);let t={};if(!e.locale)return e.toLocaleString();e.locale?.timeZone&&(t={timeZone:e.locale.timeZone});try{return e.toLocaleString(e.locale?.locale,t)}catch{return m(e)}},s=(e,...t)=>{e=l(e);let[o,D]=[e.locale,e.timeZone],I=j(e);try{return t.length===1?p(e,t[0],I):t.length?p(e,...t):e.toLocaleString(o,D?{timeZone:D}:void 0)}catch{return m(l(e))}},f=(e,t)=>Object.getPrototypeOf(t||"").constructor===Object&&Object.entries(t).filter(([,o])=>i(o)).forEach(([o,D])=>e[`set${o}`](+D))&&!0||!1,c=function(e,t){return f(e,t)||e.getDate()},i=e=>!isNaN(parseInt(e)),d=Z(),S=e=>[e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()],y=e=>[e.getFullYear(),e.getMonth(),e.getDate()],N=(e,t)=>{let o=S(e),D=t?`.${o.pop()}`.padStart(3,"0"):"";return`${o.slice(0,3).map(I=>`${I}`.padStart(2,"0")).join(":")}${D}`},b=function(e,t){return f(e,t)||S(e)},M=(e,t)=>l(new Date(e,t+1,1,0,0,0)).yesterday.getDate(),$=e=>[e.getFullYear(),e.getMonth(),e.getDate()],T=e=>l(new Date(e)),L=w(),F=(e,...t)=>l(L(e,...t)),A=function(e,{locale:t,timeZone:o}={}){[t,o]=[t||e.localeInfo?.locale,o||e.localeInfo?.timeZone];let D=[`${t?`l:${t}`:""}`,`${o?`tz:${o}`:""}`].filter(I=>I).join(", ");return e.localeInfo={formats:D,...t?{locale:t}:{},...o?{timeZone:o}:{}},e.localeInfo},j=e=>{e=l(e);let[t,o]=[e.localeInfo?.locale,e.localeInfo?.timeZone];return[`${t?`l:${t}`:""}`,`${o?`tz:${o}`:""}`].filter(D=>D).join(", ")},W=e=>{e=l(e),delete e.localeInfo},z=function(e,t,o){return e=l(e),e.locale={locale:t,timeZone:o},e},C=function(e,t){return e=l(e),e.format(t?"MM":"WD",`l:${e.locale?.locale||"utc"}`)};return{clone:T,currentLocalTime4TZ:u,year:(e,t)=>t&&e.setFullYear(t)||e.getFullYear(),month:(e,t)=>t&&e.setMonth(v-1)||e.getMonth()+1,date:(e,{year:t,month:o,date:D}={})=>c(e,{FullYear:t,Month:i(o)?o-1:o,Date:D}),hour:(e,t)=>t&&e.setHours(t)||e.getHours(),minutes:(e,t)=>t&&e.setMinutes(t)||e.getMinutes(),seconds:(e,t)=>t&&e.setSeconds(t)||e.getSeconds(),cloneTimeTo:e=>t=>r(e,t),cloneDateTo:e=>t=>n(e,t),time:(e,{hour:t,minutes:o,seconds:D,milliseconds:I}={})=>b(e,{Hours:t,Minutes:o,Seconds:D,Milliseconds:I}),timeStr:e=>(t=!1)=>N(e,t),ms:(e,t)=>t&&e.setMilliseconds(t)||e.getMilliseconds(),monthName:e=>C(e,!0),weekDay:e=>C(e),self:e=>e,local:e=>h(e),locale:(e,{locale:t,timeZone:o}={})=>g(e,{locale:t,timeZone:o}),removeLocale:e=>()=>W(e),relocate:e=>({locale:t,timeZone:o}={})=>z(e,t,o),differenceFrom:e=>t=>d({start:e,end:t}),values:e=>t=>a(e,t),ISO:e=>e.toISOString(),daysInMonth:e=>M(e.getFullYear(),e.getMonth()),isLeapYear:e=>M(e.getFullYear(),1)===29,format:e=>(...t)=>s(e,...t),addYears:e=>(t=1)=>F(e,`${t} years`),addMonths:e=>(t=1)=>F(e,`${t} months`),addWeeks:e=>(t=1)=>F(e,`${t*7} days`),addDays:e=>(t=1)=>F(e,`${t} days`),nextYear:e=>F(e,"1 year"),nextWeek:e=>F(e,"7 days"),previousWeek:e=>F(e,"subtract, 7 days"),previousYear:e=>F(e,"subtract, 1 year"),nextMonth:e=>F(e,"1 month"),previousMonth:e=>F(e,"subtract, 1 month"),tomorrow:e=>F(e,"1 day"),yesterday:e=>F(e,"subtract, 1 day"),add:e=>(...t)=>F(e,...t),subtract:e=>(...t)=>F(e,...["subtract"].concat([t]).flat())}}var R=k();function k(){let l=x(a),p={get:(n,r)=>!n[r]&&l[r]?.(n)||g(n,r),set:(n,r,m)=>l[r]?.(n,m)||n[r],ownKeys:n=>Object.getOwnPropertyNames(l),has:(n,r)=>r in l||r in n};function a(n){return new Proxy(n,p)}function g(n,r){return r in n&&n[r]instanceof Function?n[r].bind(n):n[r]}function u(n,r){let m=n?.locale||n?.timeZone,h=(n||"")instanceof Date,s=m?new Date:new Date(h?n:Date.parse(n)),f=isNaN(s)?new Date(Date.now()):s,c=a(f);return(m||r)&&(c.locale=m?n:r),c}return u.extendWith=function({name:n,fn:r,isMethod:m=!1,proxifyResult:h=!1}={}){if(!n||!r||!(r instanceof Function))return console.error("es-date-fiddler (extendWith): cannot extend without name and/or fn (function)");l[n]=s=>(s=a(s),s.localeInfo&&s.relocate(s.localeInfo),m?(...f)=>h?a(r(s,...f)):r(s,...f):h?a(r(s)):r(s))},u}export{k as DateXFactory,R as default};
