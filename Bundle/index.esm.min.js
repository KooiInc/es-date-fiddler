var z=X;function X(){let l=Object.entries({year:"FullYear",month:"Month",date:"Date",day:"Date",hour:"Hours",minute:"Minutes",second:"Seconds",millisecond:"Milliseconds"}).reduce((a,[y,u])=>({...a,[y]:u,[`${y}s`]:u}),{}),S=function(...a){if(a.length<1)return[];let y;a[0].startsWith("subtract")&&(y=!0,a[0].startsWith("subtract")&&a.length===1&&(a=a[0].split(",")),a=a.slice(1));let u=a.length===1?a[0]?.split(/,/):a;return u&&u.length&&(a=u.map(o=>o.trim())),a.map(function(o){return o.toLowerCase().split(/\s/).map(r=>(r=r.trim(),+r?y?-r:+r:r))})};return function(a,...y){let u=S(...y);return u.length&&u.forEach(([o,r])=>{r=l[r],+o&&r&&a[`set${r}`](a[`get${r}`]()+ +o)}),a}}var A=_;function _(){let l=(y,u)=>{let o=isNaN(y),r=isNaN(u);if(o&&!r){let[m,p,c]=Array(3).fill("start- and/or end date are not valid");return{error:!0,message:m,full:p,clean:c}}if(r){let[m,p,c]=Array(3).fill("end date not valid");return{error:!0,message:m,full:p,clean:c}}if(o){let[m,p,c]=Array(3).fill("start date not valid");return{error:!0,message:m,full:p,clean:c}}return{error:!1}},S=a();return function({start:u,end:o}={}){let r=new Date(Date.parse(u)),m=new Date(Date.parse(o)),p=l(r,m);if(p.error)return p;let c=new Date(u),f=new Date(o),s=Math.abs(f-c),i=new Date(s),d=i.getUTCFullYear()-1970,M=i.getUTCMonth(),h=i.getUTCDate()-1,C=i.getUTCHours(),b=i.getUTCMinutes(),I=i.getUTCSeconds(),$=i.getUTCMilliseconds(),N={from:c,to:f,years:d,months:M,days:h,hours:C,minutes:b,seconds:I,milliseconds:$};return N.full=S({values:N,full:!0}),N.clean=S({values:N}),N};function a(){let y=(...c)=>f=>c.reduce((s,i)=>i(s),f),u=(c,f)=>c===1?f.slice(0,-1):f;return y(({values:c,full:f})=>[Object.entries(c).filter(([s])=>/^(years|month|days|hours|minutes|seconds)/i.test(s)),f],([c,f])=>f?c:c.filter(([,s])=>f?+s:s>0),c=>c.reduce((f,[s,i])=>[...f,`${i} ${u(i,s)}`],[]),c=>c.length<1?"Dates are equal":`${c.slice(0,-1).join(", ")}${c.length>1?" and ":""}${c.slice(-1).shift()}`)}}var J=j();function j(){let[l,S,a,y]=["2-digit","numeric","long","short"],u={fixed:{MM:{month:a},M:{month:y},m:{month:S},mm:{month:l},yyyy:{year:S},yy:{year:l},WD:{weekday:a},wd:{weekday:y},d:{day:S},dd:{day:l},h:{hour:S},hh:{hour:l},mi:{minute:S},mmi:{minute:l},s:{second:S},ss:{second:l},ms:{fractionalSecondDigits:3},tz:{timeZoneName:"shortOffset"},dl:{locale:"default"},h12:{hour12:!1},yn:{yearName:""},ry:{relatedYear:!0},msp:{fractionalSecond:!0}},dynamic:{tzn:s=>({timeZoneName:s.slice(4)}),hrc:s=>({hourCycle:`h${s.slice(4)}`}),ds:s=>({dateStyle:s.slice(3)}),ts:s=>({timeStyle:s.slice(3)}),tz:s=>({timeZone:s.slice(3)}),e:s=>({era:s.slice(2)}),l:s=>({locale:s.slice(2)})}},o={...u,retrieveDyn(s){let i=s?.slice(0,s.indexOf(":"));return u.dynamic[i]&&u.dynamic[i](s)},get re(){return new RegExp(`\\b(${Object.keys(u.fixed).join("|")})\\b`,"g")}},r=(s="dtf",i=0)=>{let d=` ${s.replace(/(?<=\{)(.+?)(?=})/g,h=>`[${i++}]`).replace(/[{}]/g,"").trim()} `,M=s.match(/(?<=\{)(.+?)(?=})/g)||[];return{get texts(){return M},formatString(h){d=h},set formatStr(h){d=h},get formatStr(){return d},get units(){return d.match(o.re)||[]},finalize(h="",C="",b="",I=""){return d.replace(/~([\d+]?)/g,"$1").replace(/dtf/,h).replace(/era/,b).replace(/dp\b|~dp\b/,C).replace(/yn\b/,I).replace(/\[(\d+?)]/g,($,N)=>M[N].trim()).trim()}}},m=s=>s.replace(/\s+/g,""),p=(...s)=>s?.reduce((i,d)=>({...i,...o.retrieveDyn(d)||o.fixed[d]}),o.fixed.dl),c=(s,i,d)=>{let M=p(...m(d).split(",")),h=Intl.DateTimeFormat(M.locale,M).format(s);return i.finalize(h)},f=(s,i,d)=>{let M=p(...i.units.concat(m(d).split(",")).flat()),h={...o.fixed},C=(I,$)=>M[I]==="numeric"&&$.startsWith("0")?$.slice(1):$,b=Intl.DateTimeFormat(M.locale,M).formatToParts(s).reduce((I,$)=>$.type==="literal"?I:{...I,[$.type]:C($.type,$.value)},{});return h.ms=M.fractionalSecondDigits?h.msp:h.ms,h.yyyy=b.relatedYear?h.ry:h.yyyy,i.formatStr=i.formatStr.replace(o.re,I=>b[Object.keys(h[I]).shift()]||I),i.finalize(void 0,b.dayPeriod,b.era,b.yearName)};return(s,i,d="l:default")=>/ds:|ts:/.test(d)?c(s,r(void 0),d):f(s,r(i||void 0),d)}var H=q;function q(l){let S=j(),a=(e,t)=>{let n={year:e.getFullYear(),month:e.getMonth()+1,date:e.getDate(),hour:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds(),milliseconds:e.getMilliseconds()};return t?Object.values(n):n},y=(e,{locale:t,timeZone:n}={})=>((t||n)&&(e.localeInfo=P(e,{locale:t,timeZone:n})),e.localeInfo),u=e=>t=>(t={timeZone:t,hourCycle:"h23"},new Date(new Date().toLocaleString("en",t)).toLocaleString("en-CA",{hourCycle:"h23"})),o=(e,t)=>{t=l(t??new Date);let n=l(e);if(t){let{year:g,month:D,date:T}=n;t.date={year:g,month:D,date:T},n.locale&&(t.locale={locale:n.locale.locale,timeZone:n.locale.timeZone})}return t},r=(e,t)=>{t=l(t??new Date);let n=l(e),{hour:g,minutes:D,seconds:T,ms:Y}=n;return t.time={hour:g,minutes:D,seconds:T,milliseconds:Y},n.locale&&(t.locale={locale:n.locale.locale,timeZone:n.locale.timeZone}),t},m=function(e){let n=x(e)?.replace(/l:/,"locale: ").replace(/tz:/,"timeZone: ");return e.toLocaleString()+` !!invalid locale info => ${n}`},p=e=>{e=l(e);let t={};if(!e.locale)return e.toLocaleString();e.locale?.timeZone&&(t={timeZone:e.locale.timeZone});try{return e.toLocaleString(e.locale?.locale,t)}catch{return m(e)}},c=(e,...t)=>{e=l(e);let[n,g]=[e.locale,e.timeZone],D=x(e);try{return t.length===1?S(e,t[0],D):t.length?S(e,...t):e.toLocaleString(n,g?{timeZone:g}:void 0)}catch{return m(l(e))}},f=function(e,{year:t,month:n,date:g}={}){if([t,n,g].filter(s).length){let D=M(e);n=isNaN(+n)?D[1]:+n-1;let[T,Y,O]=[t,n,g].map((w,Z)=>isNaN(parseInt(w))?D[Z]:+w);return e.setFullYear(T),e.setMonth(Y),e.setDate(O),!0}return e.getDate()},s=e=>!isNaN(parseInt(e)),i=A(),d=e=>[e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()],M=e=>[e.getFullYear(),e.getMonth(),e.getDate()],h=(e,t)=>{let n=d(e),g=t?`.${n.pop()}`.padStart(3,"0"):"";return`${n.slice(0,3).map(D=>`${D}`.padStart(2,"0")).join(":")}${g}`},C=function(e,{hour:t,minutes:n,seconds:g,milliseconds:D}={}){if([t,n,g,D].filter(s).length){let T=d(e),[Y,O,w,Z]=[t,n,g,D].map((W,k)=>isNaN(parseInt(W))?T[k]:+W);return e.setHours(Y),e.setMinutes(O),e.setSeconds(w),e.setMilliseconds(Z),!0}return d(e)},b=(e,t)=>l(new Date(e,t+1,1,0,0,0)).yesterday.getDate(),I=e=>[e.getFullYear(),e.getMonth(),e.getDate()],$=e=>l(new Date(e)),N=z(),F=(e,...t)=>l(N(e,...t)),P=function(e,{locale:t,timeZone:n}={}){[t,n]=[t||e.localeInfo?.locale,n||e.localeInfo?.timeZone];let g=[`${t?`l:${t}`:""}`,`${n?`tz:${n}`:""}`].filter(D=>D).join(", ");return e.localeInfo={formats:g,...t?{locale:t}:{},...n?{timeZone:n}:{}},e.localeInfo},x=e=>{e=l(e);let[t,n]=[e.localeInfo?.locale,e.localeInfo?.timeZone];return[`${t?`l:${t}`:""}`,`${n?`tz:${n}`:""}`].filter(g=>g).join(", ")},U=e=>{e=l(e),delete e.localeInfo},E=function(e,t,n){return e=l(e),e.locale={locale:t,timeZone:n},e},L=function(e,t){return e=l(e),e.format(t?"MM":"WD",`l:${e.locale?.locale||"utc"}`)};return{clone:$,currentLocalTime4TZ:u,year:(e,t)=>t&&e.setFullYear(t)||e.getFullYear(),month:(e,t)=>t&&e.setMonth(v-1)||e.getMonth()+1,date:(e,{year:t,month:n,date:g}={})=>f(e,{year:t,month:n,date:g}),hour:(e,t)=>t&&e.setHours(t)||e.getHours(),minutes:(e,t)=>t&&e.setMinutes(t)||e.getMinutes(),seconds:(e,t)=>t&&e.setSeconds(t)||e.getSeconds(),cloneTimeTo:e=>t=>r(e,t),cloneDateTo:e=>t=>o(e,t),time:(e,{hour:t,minutes:n,seconds:g,milliseconds:D}={})=>C(e,{hour:t,minutes:n,seconds:g,milliseconds:D}),timeStr:e=>(t=!1)=>h(e,t),ms:(e,t)=>t&&e.setMilliseconds(t)||e.getMilliseconds(),monthName:e=>L(e,!0),weekDay:e=>L(e),self:e=>e,local:e=>p(e),locale:(e,{locale:t,timeZone:n}={})=>y(e,{locale:t,timeZone:n}),removeLocale:e=>()=>U(e),relocate:e=>({locale:t,timeZone:n}={})=>E(e,t,n),differenceFrom:e=>t=>i({start:e,end:t}),values:e=>t=>a(e,t),ISO:e=>e.toISOString(),daysInMonth:e=>b(e.getFullYear(),e.getMonth()),isLeapYear:e=>b(e.getFullYear(),1)===29,format:e=>(...t)=>c(e,...t),addYears:e=>(t=1)=>F(e,`${t} years`),addMonths:e=>(t=1)=>F(e,`${t} months`),addWeeks:e=>(t=1)=>F(e,`${t*7} days`),addDays:e=>(t=1)=>F(e,`${t} days`),nextYear:e=>F(e,"1 year"),nextWeek:e=>F(e,"7 days"),previousWeek:e=>F(e,"subtract, 7 days"),previousYear:e=>F(e,"subtract, 1 year"),nextMonth:e=>F(e,"1 month"),previousMonth:e=>F(e,"subtract, 1 month"),tomorrow:e=>F(e,"1 day"),yesterday:e=>F(e,"subtract, 1 day"),add:e=>(...t)=>F(e,...t),subtract:e=>(...t)=>F(e,...["subtract"].concat([t]).flat())}}var oe=G();function G(){let l=H(a),S={get:(o,r)=>!o[r]&&l[r]?.(o)||y(o,r),set:(o,r,m)=>l[r]?.(o,m)||o[r],ownKeys:o=>Object.getOwnPropertyNames(l),has:(o,r)=>r in l||r in o};function a(o){return new Proxy(o,S)}function y(o,r){return r in o&&o[r]instanceof Function?o[r].bind(o):o[r]}function u(o,r){let m=o?.locale||o?.timeZone,p=(o||"")instanceof Date,c=m?new Date:new Date(p?o:Date.parse(o)),f=isNaN(c)?new Date(Date.now()):c,s=a(f);return(m||r)&&(s.locale=m?o:r),s}return u.extendWith=function({name:o,fn:r,isMethod:m=!1,proxifyResult:p=!1}={}){if(!o||!r||!(r instanceof Function))return console.error("es-date-fiddler (extendWith): cannot extend without name and/or fn (function)");l[o]=c=>(c=a(c),c.localeInfo&&c.relocate(c.localeInfo),m?(...f)=>p?a(r(c,...f)):r(c,...f):p?a(r(c)):r(c))},u}export{G as DateXFactory,oe as default};
