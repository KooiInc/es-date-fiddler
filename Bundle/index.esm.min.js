var K=se;function se(){let s=Object.entries({year:"FullYear",month:"Month",date:"Date",day:"Date",hour:"Hours",minute:"Minutes",second:"Seconds",millisecond:"Milliseconds"}).reduce((f,[D,h])=>({...f,[D]:h,[`${D}s`]:h}),{}),F=function(...f){if(f.length<1)return[];let D;f[0].startsWith("subtract")&&(D=!0,f[0].startsWith("subtract")&&f.length===1&&(f=f[0].split(",")),f=f.slice(1));let h=f.length===1?f[0]?.split(/,/):f;return h&&h.length&&(f=h.map(g=>g.trim())),f.map(function(g){return g.toLowerCase().split(/\s/).map(u=>(u=u.trim(),parseInt(u)?D?-u:+u:u))})};return function(f,...D){let h=F(...D);return h.length&&h.forEach(([g,u])=>{u=s[u],+g&&u&&f[`set${u}`](f[`get${u}`]()+ +g)}),f}}var X=ce;function ce(){let s=(D,h)=>{let g=isNaN(D),u=isNaN(h);if(g&&!u){let[N,T,i]=Array(3).fill("start- and/or end date are not valid");return{error:!0,message:N,full:T,clean:i}}if(u){let[N,T,i]=Array(3).fill("end date not valid");return{error:!0,message:N,full:T,clean:i}}if(g){let[N,T,i]=Array(3).fill("start date not valid");return{error:!0,message:N,full:T,clean:i}}return{error:!1}},F=f();return function({start:h,end:g}={}){let u=new Date(Date.parse(h)),N=new Date(Date.parse(g)),T=s(u,N);if(T.error)return T;let i=new Date(h),b=new Date(g),I=Math.abs(b-i),n=new Date(I),o=n.getUTCFullYear()-1970,c=n.getUTCMonth(),l=n.getUTCDate()-1,a=n.getUTCHours(),d=n.getUTCMinutes(),p=n.getUTCSeconds(),w=n.getUTCMilliseconds(),y={from:i,to:b,years:o,months:c,days:l,hours:a,minutes:d,seconds:p,milliseconds:w};return y.full=F({values:y,full:!0}),y.clean=F({values:y}),y};function f(){let D=(...i)=>b=>i.reduce((I,n)=>n(I),b),h=(i,b)=>i===1?b.slice(0,-1):b;return D(({values:i,full:b})=>[Object.entries(i).filter(([I])=>/^(years|month|days|hours|minutes|seconds)/i.test(I)),b],([i,b])=>b?i:i.filter(([,I])=>b?+I:I>0),i=>i.reduce((b,[I,n])=>[...b,`${n} ${h(n,I)}`],[]),i=>i.length<1?"Dates are equal":`${i.slice(0,-1).join(", ")}${i.length>1?" and ":""}${i.slice(-1).shift()}`)}}var me=q();function q(){let[s,F,f,D]=["2-digit","numeric","long","short"],h={fixed:{MM:{month:f},M:{month:D},m:{month:F},mm:{month:s},yyyy:{year:F},yy:{year:s},WD:{weekday:f},wd:{weekday:D},d:{day:F},dd:{day:s},h:{hour:F},hh:{hour:s},mi:{minute:F},mmi:{minute:s},s:{second:F},ss:{second:s},ms:{fractionalSecondDigits:3},tz:{timeZoneName:"shortOffset"},dl:{locale:"default"},h12:{hour12:!1},yn:{yearName:""},ry:{relatedYear:!0},msp:{fractionalSecond:!0}},dynamic:{tzn:n=>({timeZoneName:n.slice(4)}),hrc:n=>({hourCycle:`h${n.slice(4)}`}),ds:n=>({dateStyle:n.slice(3)}),ts:n=>({timeStyle:n.slice(3)}),tz:n=>({timeZone:n.slice(3)}),e:n=>({era:n.slice(2)}),l:n=>({locale:n.slice(2)})}},g={...h,retrieveDyn(n){let o=n?.slice(0,n.indexOf(":"));return h.dynamic[o]&&h.dynamic[o](n)},get re(){return new RegExp(`\\b(${Object.keys(h.fixed).join("|")})\\b`,"g")}},u=(n="dtf",o=0)=>{let c=` ${n.replace(/(?<=\{)(.+?)(?=})/g,a=>`[${o++}]`).replace(/[{}]/g,"").trim()} `,l=n.match(/(?<=\{)(.+?)(?=})/g)||[];return{get texts(){return l},formatString(a){c=a},set formatStr(a){c=a},get formatStr(){return c},get units(){return c.match(g.re)||[]},finalize(a="",d="",p="",w=""){return c.replace(/~([\d+]?)/g,"$1").replace(/dtf/,a).replace(/era/,p).replace(/dp\b|~dp\b/,d).replace(/yn\b/,w).replace(/\[(\d+?)]/g,(y,S)=>l[S].trim()).trim()}}},N=n=>n.replace(/\s+/g,""),T=(...n)=>n?.reduce((o,c)=>({...o,...g.retrieveDyn(c)||g.fixed[c]}),g.fixed.dl),i=(n,o,c)=>{let l=T(...N(c).split(",")),a=Intl.DateTimeFormat(l.locale,l).format(n);return o.finalize(a)},b=(n,o,c,l)=>n.toLocaleString(o,{timeZone:c,month:l?D:f}),I=(n,o,c)=>{let l=T(...o.units.concat(N(c).split(",")).flat()),a={...g.fixed},d=(w,y)=>l[w]==="numeric"&&y.startsWith("0")?y.slice(1):y,p=Intl.DateTimeFormat(l.locale,l).formatToParts(n).reduce((w,y)=>y.type==="literal"&&/[ ,/-]/.test(y.value)?w:{...w,[y.type]:d(y.type,y.value)},{});return a.ms=l.fractionalSecondDigits?a.msp:a.ms,a.yyyy=p.relatedYear?a.ry:a.yyyy,o.formatStr=o.formatStr.replace(g.re,w=>/^(M|MM)$/.test(w)?b(n,l.locale,l.timeZone,/^M$/.test(w)):p[Object.keys(a[w]).shift()]||w),o.finalize(void 0,p.dayPeriod,p.era,p.yearName)};return(n,o,c="l:default")=>/ds:|ts:/.test(c)?i(n,u(void 0),c):I(n,u(o||void 0),c)}var J=ae;function ae(s,F){let f=q(),D=e=>!(isNaN(parseInt(e))&&isNaN(+e)),h=e=>e?.constructor===Object,g=e=>+e.slice(e.indexOf("+")+1).replace(":","")||0,u=e=>e.localeInfo?.timeZone||Intl.DateTimeFormat().resolvedOptions().timeZone,N=e=>e.map(t=>String(t)?.padStart(2,"0")??t),T=e=>N(o(e)).join("-"),i=e=>Object.entries(e).filter(([,t])=>D(t)),b=e=>console.error(`clone${e?"Time":"Date"}To: no toDate given`),I=(e,t)=>h(t)&&i(t).forEach(([r,m])=>e[`set${r}`](m))&&!0||!1,n=e=>s(e).format("hh,mi,ss,ms").split(",").map(Number),o=e=>s(e).format("yyyy,mm,dd").split(",").map(Number),c=(e,t)=>I(e,t)||n(e),l=(e,t)=>I(e,t)||o(e),a=X(),d=(e,t)=>s(new Date(e,t+1,1,0,0,0)).yesterday.getDate(),p=e=>s(new Date(e)).relocate(e.localeInfo?.locale,e.localeInfo?.timeZone),w=e=>s(new Date(e)).relocate(),y=K(),S=(e,...t)=>s(y(e,...t)),A=(e,t)=>[`${e&&!(Array.isArray(e)&&e.length<1)?`l:${e}`:""}`,`${t?`tz:${t}`:""}`].filter(r=>r).join(","),Y=e=>(delete e.localeInfo,s(e)),P=function(e,t){e=s(e);let{locale:r,timeZone:m}=e.localeInfo;return e.format(t?"MM":"WD",A(r,m))},k=e=>`.${String(e.getMilliseconds()).padStart(3,"0")}`,E=(e,t)=>e.toLocaleTimeString("en-GB",{timeZone:e.localeInfo?.timeZone})+(t?`${k(e)}`:"");function Z(e,{locale:t,timeZone:r,validate:m=!0}={}){return e.localeInfo=t||r?z(e,{locale:t,timeZone:r,validate:m}):e.localeInfo,e.localeInfo}function z(e,{locale:t,timeZone:r}={}){let m=F(t,r);return e.localeInfo={locale:m.locale,timeZone:m.timeZone},e.formats=A(e.localeInfo.locale,e.localeInfo.timeZone),e.localeInfo}function U(e){e=s(e);let{locale:t,timeZone:r}=e.locale,m=r?{timeZone:r}:{};return e.toLocaleDateString(t,m)}function Q(e){let t=u(e),r=new Date(e.getFullYear(),0,1,14),m=new Date(new Date(r).setMonth(6)),$=Intl.DateTimeFormat("en-CA",{year:"numeric",timeZone:t,timeZoneName:"shortOffset"}),[M,O]=[$.format(r),$.format(m)];return g(M)-g(O)!==0}function V(e,t,r){return t||r?(Z(e,{locale:t,timeZone:r}),s(e)):(e.localeInfo||Z(e,F()),s(e))}function R(e,t){t=s(t??new Date);let r=s(e),{hour:m,minutes:$,seconds:M,ms:O}=r;return t.time={hour:m,minutes:$,seconds:M,ms:O},r.locale?(t.locale={locale:r.locale.locale,timeZone:r.locale.timeZone},t):(b(1),r)}function ee(e){e=s(e);let{locale:t,timeZone:r}=e.locale??F();return e.toLocaleString(t,{timeZone:r})}function te(e,...t){e=s(e);let r,m,$;return e.locale&&(r=e.locale.locale,m=e.locale.timeZone,$=e.formats),t.length===1?f(e,t[0],$):t.length?f(e,...t):e.toLocaleString(r||[],m?{timeZone:m}:void 0)}function ne(e,t){t=s(t??new Date);let r=s(e);if(t){let[m,$,M]=r.date;return t.date={year:m,month:$,date:M},r.locale&&(t.locale={locale:r.locale.locale,timeZone:r.locale.timeZone}),t}return b(),r}function x(e){let t={timeZone:u(e),hourCycle:"h23"};try{return s(new Date(new Date(e.toLocaleString("en",t))))}catch(r){return console.error(`Can't retrieve localized date/time value for ${t.timeZone}: ${r.message}`),s(e)}}function j(e){let t=e.getMonth();e=s(e);let[r,m]=e.format("MM,WD").split(","),[$,M,O,C,W,H,_,B]=e.format("yyyy,m,dd,hh,mmi,ss,ms,dp").split(","),re=e.localeInfo?F(e.localeInfo.locale,e.localeInfo.timeZone):F();return{year:+$,month:+M,date:+O,hour:+C,minutes:+W,seconds:+H,milliseconds:+_,dayPeriod:B!==""?B:"n/a",monthName:r,weekDay:m,resolvedLocale:re,valuesArray:[$,+M-1,O,C,W,H,_].map(Number)}}function G(e,t=!1){let r=x(e),m=x(t?s(e).clone.relocate({timeZone:"Etc/UTC"}):new Date(e));m.time=r.time={milliseconds:0};let $=r.differenceFrom(m).clean,M=/equal/.test($);return`${M?"":+r>=+m?"+":"-"}${M?"no difference":$}`}function oe(e,t){let r=0;for(e=s(e),t=s(t),e.time=t.time={hour:0,minutes:0,seconds:0,milliseconds:0},e>t&&([e,t]=[t,e]);e<t;)e.add("1 day"),r+=1;return r}function L(e,{day:t,next:r=!1,midnight:m=!0,forFirstWeekday:$=!1}={}){e=s(e);let M=e.clone,O=M.getDay();M.time=m?{hour:0,minutes:0,seconds:0,milliseconds:0}:{};let C="sun,mon,tue,wed,thu,fri,sat".split(",").findIndex(H=>H===t),W=`${r?1:-1} days`;return $&&O===C?M:C<0?e:function(){for(O=O===C?M.add(W).getDay():O;O!==C;)O=M.add(W).getDay();return M}()}return{clone:p,cloneLocal:w,hasDST:Q,dateStr:U,timeZone:e=>u(e),firstWeekday:e=>({sunday:t=!1,midnight:r=!1}={})=>L(e,{day:t?"sun":"mon",midnight:r,forFirstWeekday:!0}),next:e=>(t,{midnight:r=!1}={})=>L(e,{day:t,midnight:r,next:!0}),previous:e=>(t,{midnight:r=!1}={})=>L(e,{day:t,midnight:r}),year:(e,t)=>t&&e.setFullYear(t)||j(e).year,month:(e,t)=>t&&e.setMonth(v-1)||j(e).month,date:(e,{year:t,month:r,date:m}={})=>l(e,{FullYear:t,Month:D(r)?r-1:r,Date:m}),hour:(e,t)=>t&&e.setHours(t)||j(e).hour,minutes:(e,t)=>t&&e.setMinutes(t)||j(e).minutes,seconds:(e,t)=>t&&e.setSeconds(t)||j(e).seconds,cloneTimeTo:e=>t=>R(e,t),cloneDateTo:e=>t=>ne(e,t),local:e=>ee(e),locale:(e,{locale:t,timeZone:r}={})=>Z(e,{locale:t,timeZone:r}),removeLocale:e=>Y(e),relocate:e=>({locale:t,timeZone:r}={})=>V(e,t,r),timeDiffToHere:e=>G(e),timeDiffToUTC:e=>G(e,!0),time:(e,{hour:t,minutes:r,seconds:m,milliseconds:$}={})=>c(e,{Hours:t,Minutes:r,Seconds:m,Milliseconds:$}),timeStr:e=>(t=!1)=>E(e,t),dateISOStr:e=>T(e),ms:(e,t)=>t&&e.setMilliseconds(t)||e.getMilliseconds(),monthName:e=>P(e,!0),weekDay:e=>P(e),self:e=>e,differenceFrom:e=>t=>a({start:e,end:t}),values:e=>j(e),ISO:e=>e.toISOString(),daysInMonth:e=>d(e.getFullYear(),e.getMonth()),isLeapYear:e=>d(e.getFullYear(),1)===29,format:e=>(...t)=>te(e,...t),daysUntil:e=>t=>oe(e,t),addYears:e=>(t=1)=>S(e,`${t} years`),addMonths:e=>(t=1)=>S(e,`${t} months`),addWeeks:e=>(t=1)=>S(e,`${t*7} days`),addDays:e=>(t=1)=>S(e,`${t} days`),nextYear:e=>S(e,"1 year"),nextWeek:e=>S(e,"7 days"),previousWeek:e=>S(e,"subtract, 7 days"),previousYear:e=>S(e,"subtract, 1 year"),nextMonth:e=>S(e,"1 month"),previousMonth:e=>S(e,"subtract, 1 month"),tomorrow:e=>S(e,"1 day"),yesterday:e=>S(e,"subtract, 1 day"),add:e=>(...t)=>S(e,...t),subtract:e=>(...t)=>S(e,...["subtract"].concat([t]).flat())}}var pe=ie();function ie(){let s=J(u,D),F={get:(n,o)=>n[o]?N(n,o):s[o]?.(n),set:(n,o,c)=>s[o]?s[o](n,c):n[o],ownKeys:()=>Object.getOwnPropertyNames(s),has:(n,o)=>o in s||o in n};function f({name:n,fn:o,root:c,isMethod:l,proxifyResult:a}={}){if(!n||!o||!(o instanceof Function))return console.error("es-date-fiddler (extendWith): cannot extend without name and/or fn (function)");if(c)return Object.defineProperty(i,n,{value:(...d)=>{let p=o(...d);return p instanceof Date?u(p):p}}),console.log(`\u2714 created '${n}' root level method`);s=Object.freeze({...s,[n]:d=>(d=u(d),d.localeInfo&&d.relocate(d.localeInfo),l?(...p)=>a?u(o(d,...p)):o(d,...p):a?u(o(d)):o(d))}),console.log(`\u2714 created '${n}' ${l?"method":"getter"}`)}function D(n,o,c=!0){let l=a=>console.error(`invalid locale (time zone: "${a.timeZone}", locale: "${a.locale}"), associated your locale instead`);try{return Intl.DateTimeFormat(n,{timeZone:o}).resolvedOptions()}catch{return c&&l({locale:n,timeZone:o}),Intl.DateTimeFormat().resolvedOptions()}}function h(){return i()}function g({locale:n,timeZone:o}={}){if(!n&&!o)return!1;let c=D(n,o,!1);return n&&!o?c.locale===n:(o&&!n||c.locale===n)&&o===c.timeZone}function u(n){return new Proxy(n,F)}function N(n,o){return o in n&&n[o]instanceof Function?n[o].bind(n):n[o]}function T(){let n={mgm:"mutating getter method",c:"chainable",g:"getter",s:"setter",mg:"mutating getter",gm:"getter method"},o={};return Object.entries(Object.getOwnPropertyDescriptors(s)).sort(([c],[l])=>c.localeCompare(l)).forEach(([c,l])=>{let a=String(l.value).match(/(?<=\/\*).+?(?=\*\/)/)?.shift()?.split(",")?.map(d=>n[d]).join(", ");a&&(o[c]=a)}),Object.keys(o).length<1?(console.error("$D.describe can only be used with uncompressed code"),{}):o}function i(n,o){n=Array.isArray(n)?new Date(...n):n;let c=n?.locale||n?.timeZone,l=(n||"")instanceof Date,a=c?new Date:new Date(l?n:Date.parse(n)),d=isNaN(a)?new Date(Date.now()):a;return u(d).relocate(c?n:o)}function b(n,o){let c=i(n.replace(/T/," ")),l=i(o);return c.date.join("")===l.date.join("")}function I(n,o="ymd"){n=n.trim();let c=n?.split(/[T :\-\/.,]/g).filter(d=>!!d.trim()),l=()=>{let d=[...o].reduce((Z,z,U)=>(Z[z]=U,Z),{}),p=c.slice(0,3),w=c.slice(3),[y,S,A,Y,P,k,E]=[+p[d.y],+p[d.m]-1,+p[d.d]].concat([...Array(4)].map((Z,z)=>+w[z]||0));return y<1900?new Date(new Date(y,S,A,Y,P,k,E).setFullYear(y)):new Date(y,S,A,Y,P,k,E)},a={get cando(){return l()},get cannot(){if(!n||c?.length<3)return console.error(`dateFromString: can't convert "${n||"empty date string"}" to ES-Date`),!0;if(!b(n,l()))return console.error(`dateFromString: not what we expected. Check your input ("${n}" and "${o}")`),!0}};return a.cannot?new Date(NaN):a.cando}return Object.defineProperties(i,{now:{get(){return h()}},extendWith:{get(){return f}},validateLocale:{get(){return g}},ownFns:{get(){return Object.getOwnPropertyDescriptors(s)}},describe:{get(){return T()}},dateFromString:{value:I}}),i}export{ie as DateXFactory,pe as default};
