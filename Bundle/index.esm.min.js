var A=J;function J(){let a=Object.entries({year:"FullYear",month:"Month",date:"Date",day:"Date",hour:"Hours",minute:"Minutes",second:"Seconds",millisecond:"Milliseconds"}).reduce((l,[h,u])=>({...l,[h]:u,[`${h}s`]:u}),{}),p=function(...l){if(l.length<1)return[];let h;l[0].startsWith("subtract")&&(h=!0,l[0].startsWith("subtract")&&l.length===1&&(l=l[0].split(",")),l=l.slice(1));let u=l.length===1?l[0]?.split(/,/):l;return u&&u.length&&(l=u.map(n=>n.trim())),l.map(function(n){return n.toLowerCase().split(/\s/).map(r=>(r=r.trim(),+r?h?-r:+r:r))})};return function(l,...h){let u=p(...h);return u.length&&u.forEach(([n,r])=>{r=a[r],+n&&r&&l[`set${r}`](l[`get${r}`]()+ +n)}),l}}var W=Q;function Q(){let a=(h,u)=>{let n=isNaN(h),r=isNaN(u);if(n&&!r){let[m,y,s]=Array(3).fill("start- and/or end date are not valid");return{error:!0,message:m,full:y,clean:s}}if(r){let[m,y,s]=Array(3).fill("end date not valid");return{error:!0,message:m,full:y,clean:s}}if(n){let[m,y,s]=Array(3).fill("start date not valid");return{error:!0,message:m,full:y,clean:s}}return{error:!1}},p=l();return function({start:u,end:n}={}){let r=new Date(Date.parse(u)),m=new Date(Date.parse(n)),y=a(r,m);if(y.error)return y;let s=new Date(u),f=new Date(n),c=Math.abs(f-s),i=new Date(c),g=i.getUTCFullYear()-1970,M=i.getUTCMonth(),D=i.getUTCDate()-1,N=i.getUTCHours(),b=i.getUTCMinutes(),I=i.getUTCSeconds(),$=i.getUTCMilliseconds(),T={from:s,to:f,years:g,months:M,days:D,hours:N,minutes:b,seconds:I,milliseconds:$};return T.full=p({values:T,full:!0}),T.clean=p({values:T}),T};function l(){let h=(...s)=>f=>s.reduce((c,i)=>i(c),f),u=(s,f)=>s===1?f.slice(0,-1):f;return h(({values:s,full:f})=>[Object.entries(s).filter(([c])=>/^(years|month|days|hours|minutes|seconds)/i.test(c)),f],([s,f])=>f?s:s.filter(([,c])=>f?+c:c>0),s=>s.reduce((f,[c,i])=>[...f,`${i} ${u(i,c)}`],[]),s=>s.length<1?"Dates are equal":`${s.slice(0,-1).join(", ")}${s.length>1?" and ":""}${s.slice(-1).shift()}`)}}var re=j();function j(){let[a,p,l,h]=["2-digit","numeric","long","short"],u={fixed:{MM:{month:l},M:{month:h},m:{month:p},mm:{month:a},yyyy:{year:p},yy:{year:a},WD:{weekday:l},wd:{weekday:h},d:{day:p},dd:{day:a},h:{hour:p},hh:{hour:a},mi:{minute:p},mmi:{minute:a},s:{second:p},ss:{second:a},ms:{fractionalSecondDigits:3},tz:{timeZoneName:"shortOffset"},dl:{locale:"default"},h12:{hour12:!1},yn:{yearName:""},ry:{relatedYear:!0},msp:{fractionalSecond:!0}},dynamic:{tzn:c=>({timeZoneName:c.slice(4)}),hrc:c=>({hourCycle:`h${c.slice(4)}`}),ds:c=>({dateStyle:c.slice(3)}),ts:c=>({timeStyle:c.slice(3)}),tz:c=>({timeZone:c.slice(3)}),e:c=>({era:c.slice(2)}),l:c=>({locale:c.slice(2)})}},n={...u,retrieveDyn(c){let i=c?.slice(0,c.indexOf(":"));return u.dynamic[i]&&u.dynamic[i](c)},get re(){return new RegExp(`\\b(${Object.keys(u.fixed).join("|")})\\b`,"g")}},r=(c="dtf",i=0)=>{let g=` ${c.replace(/(?<=\{)(.+?)(?=})/g,D=>`[${i++}]`).replace(/[{}]/g,"").trim()} `,M=c.match(/(?<=\{)(.+?)(?=})/g)||[];return{get texts(){return M},formatString(D){g=D},set formatStr(D){g=D},get formatStr(){return g},get units(){return g.match(n.re)||[]},finalize(D="",N="",b="",I=""){return g.replace(/~([\d+]?)/g,"$1").replace(/dtf/,D).replace(/era/,b).replace(/dp\b|~dp\b/,N).replace(/yn\b/,I).replace(/\[(\d+?)]/g,($,T)=>M[T].trim()).trim()}}},m=c=>c.replace(/\s+/g,""),y=(...c)=>c?.reduce((i,g)=>({...i,...n.retrieveDyn(g)||n.fixed[g]}),n.fixed.dl),s=(c,i,g)=>{let M=y(...m(g).split(",")),D=Intl.DateTimeFormat(M.locale,M).format(c);return i.finalize(D)},f=(c,i,g)=>{let M=y(...i.units.concat(m(g).split(",")).flat()),D={...n.fixed},N=(I,$)=>M[I]==="numeric"&&$.startsWith("0")?$.slice(1):$,b=Intl.DateTimeFormat(M.locale,M).formatToParts(c).reduce((I,$)=>$.type==="literal"?I:{...I,[$.type]:N($.type,$.value)},{});return D.ms=M.fractionalSecondDigits?D.msp:D.ms,D.yyyy=b.relatedYear?D.ry:D.yyyy,i.formatStr=i.formatStr.replace(n.re,I=>b[Object.keys(D[I]).shift()]||I),i.finalize(void 0,b.dayPeriod,b.era,b.yearName)};return(c,i,g="l:default")=>/ds:|ts:/.test(g)?s(c,r(void 0),g):f(c,r(i||void 0),g)}var H=V;function V(a){let p=j(),l=e=>!(isNaN(parseInt(e))&&isNaN(+e)),h=e=>e?.constructor===Object,u=e=>+e.slice(e.indexOf("+")+1).replace(":","")||0,n=e=>e.localeInfo?.timeZone||Intl.DateTimeFormat().resolvedOptions().timeZone,r=(e,t=2)=>`${e}`.padStart(t,"0"),m=e=>e.map(t=>String(t)?.padStart(2,"0")??t),y=e=>m(Y(e)).join("-"),s=e=>Object.entries(e).filter(([,t])=>l(t)),f=(e,t)=>{let o={year:e.getFullYear(),month:e.getMonth()+1,date:e.getDate(),hour:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds(),milliseconds:e.getMilliseconds()};return t?Object.values(o):o},c=e=>{let t={timeZone:n(e),hour12:!1},o;try{return a(new Date(new Date(e.toLocaleString("en",t))))}catch(d){return console.error(`Can't retrieve localized date/time value for ${t.timeZone}: ${d.message}`),a(e)}},i=e=>console.error(`clone${e?"Time":"Date"}To: no toDate given`),g=(e,t)=>{t=a(t??new Date);let o=a(e);if(t){let[d,S,Z]=o.date;return t.date={year:d,month:S,date:Z},o.locale&&(t.locale={locale:o.locale.locale,timeZone:o.locale.timeZone}),t}return i(),o},M=(e,t)=>{t=a(t??new Date);let o=a(e),{hour:d,minutes:S,seconds:Z,ms:w}=o;return t.time={hour:d,minutes:S,seconds:Z,ms:w},o.locale?(t.locale={locale:o.locale.locale,timeZone:o.locale.timeZone},t):(i(1),o)},D=function(e){let o=O(e)?.replace(/l:/,"locale: ").replace(/tz:/,"timeZone: ");return e.toLocaleString()+` !!invalid locale info => ${o}`},N=e=>{e=a(e);let t={};return e.locale?(e.locale?.timeZone&&(t={timeZone:e.locale.timeZone}),e.toLocaleString(e.locale?.locale,t)):e.toLocaleString()},b=(e,...t)=>{e=a(e);let[o,d]=[e.locale,e.timeZone],S=O(e);return t.length===1?p(e,t[0],S||void 0):t.length?p(e,...t):e.toLocaleString(o||[],d?{timeZone:d}:void 0)},I=e=>console.error(`invalid locale (time zone: "${e.timeZone}", locale: "${e.locale}"), removed associated locale information`),$=(e,t=!1)=>{if(!e.localeInfo)return!0;e="values"in e?e:a(e);try{let o=new Date(e).toLocaleString(e.localeInfo.locale??[],{timeZone:e.localeInfo.timeZone});return e}catch{return I(e.localeInfo),e.removeLocale()}},T=(e,t)=>h(t)&&s(t).forEach(([o,d])=>e[`set${o}`](d))&&!0||!1,z=e=>[e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()??0],Y=e=>[e.getFullYear(),e.getMonth()+1,e.getDate()],P=(e,t)=>T(e,t)||z(e),E=(e,t)=>T(e,t)||Y(e),U=W(),C=(e,t)=>a(new Date(e,t+1,1,0,0,0)).yesterday.getDate(),ee=e=>[e.getFullYear(),e.getMonth(),e.getDate()],k=e=>{let t=a(new Date(e));return t.relocate(e.localeInfo??{timezone:n(e)}),t},X=A(),F=(e,...t)=>a(X(e,...t)),x=(e,{locale:t,timeZone:o}={})=>((t||o)&&(e.localeInfo=_(e,{locale:t,timeZone:o}),$(e)),e.localeInfo??{}),O=e=>{let[t,o]=[e.localeInfo?.locale,e.localeInfo?.timeZone];return[`${t?`l:${t}`:""}`,`${o?`tz:${o}`:""}`].filter(d=>d).join(", ")?.trim()},_=function(e,{locale:t,timeZone:o}={}){[t,o]=[t||e.localeInfo?.locale,o||e.localeInfo?.timeZone||n(e)];let d=[`${t?`l:${t}`:""}`,`${o?`tz:${o}`:""}`].filter(S=>S).join(", ");return e.localeInfo={...t?{locale:t}:{},...o?{timeZone:o}:{}},e.localeInfo.formats=O(e),e.localeInfo},q=e=>(delete e.localeInfo,a(e)),G=function(e,t,o){return x(e,{locale:t,timeZone:o}),a(e)},L=function(e,t){return e=a(e),e.format(t?"MM":"WD",`l:${e.locale?.locale||"utc"}`)},K=e=>e.toLocaleDateString().split(/[-\/]/).map(t=>r(t)).join("-"),B=(e,t)=>{let o=z(e).reduce((d,S,Z)=>[...d,Z<3?r(S):r(S,3)],[]);return`${o.slice(0,3).join(":")}${t?`.${o.slice(-1)}`:""}`};return{clone:k,localizedDT:c,hasDST:e=>{let t=n(e),o=new Date(e.getFullYear(),0,1,14),d=new Date(new Date(o).setMonth(6)),S=Intl.DateTimeFormat("en-CA",{year:"numeric",timeZone:t,timeZoneName:"shortOffset"}),[Z,w]=[S.format(o),S.format(d)];return u(Z)-u(w)!==0},getTimezone:n,validateLocale:$,dateStr:K,year:(e,t)=>t&&e.setFullYear(t)||e.getFullYear(),month:(e,t)=>t&&e.setMonth(v-1)||e.getMonth()+1,date:(e,{year:t,month:o,date:d}={})=>E(e,{FullYear:t,Month:l(o)?o-1:o,Date:d}),hour:(e,t)=>t&&e.setHours(t)||e.getHours(),minutes:(e,t)=>t&&e.setMinutes(t)||e.getMinutes(),seconds:(e,t)=>t&&e.setSeconds(t)||e.getSeconds(),cloneTimeTo:e=>t=>M(e,t),cloneDateTo:e=>t=>g(e,t),time:(e,{hour:t,minutes:o,seconds:d,milliseconds:S}={})=>P(e,{Hours:t,Minutes:o,Seconds:d,Milliseconds:S}),timeStr:e=>(t=!1)=>B(e,t),dateISOStr:e=>y(e),ms:(e,t)=>t&&e.setMilliseconds(t)||e.getMilliseconds(),monthName:e=>L(e,!0),weekDay:e=>L(e),self:e=>e,local:e=>N(e),locale:(e,{locale:t,timeZone:o}={})=>x(e,{locale:t,timeZone:o}),removeLocale:e=>()=>q(e),relocate:e=>({locale:t,timeZone:o}={})=>G(e,t,o),differenceFrom:e=>t=>U({start:e,end:t}),values:e=>t=>f(e,t),ISO:e=>e.toISOString(),daysInMonth:e=>C(e.getFullYear(),e.getMonth()),isLeapYear:e=>C(e.getFullYear(),1)===29,format:e=>(...t)=>b(e,...t),addYears:e=>(t=1)=>F(e,`${t} years`),addMonths:e=>(t=1)=>F(e,`${t} months`),addWeeks:e=>(t=1)=>F(e,`${t*7} days`),addDays:e=>(t=1)=>F(e,`${t} days`),nextYear:e=>F(e,"1 year"),nextWeek:e=>F(e,"7 days"),previousWeek:e=>F(e,"subtract, 7 days"),previousYear:e=>F(e,"subtract, 1 year"),nextMonth:e=>F(e,"1 month"),previousMonth:e=>F(e,"subtract, 1 month"),tomorrow:e=>F(e,"1 day"),yesterday:e=>F(e,"subtract, 1 day"),add:e=>(...t)=>F(e,...t),subtract:e=>(...t)=>F(e,...["subtract"].concat([t]).flat())}}var fe=R();function R(){let a=H(l),p={get:(n,r)=>n[r]?h(n,r):a[r]?.(n),set:(n,r,m)=>a[r]?a[r](n,m):n[r],ownKeys:n=>Object.getOwnPropertyNames(a),has:(n,r)=>r in a||r in n};function l(n){return new Proxy(n,p)}function h(n,r){return r in n&&n[r]instanceof Function?n[r].bind(n):n[r]}function u(n,r){let m=n?.locale||n?.timeZone,y=(n||"")instanceof Date,s=m?new Date:new Date(y?n:Date.parse(n)),f=isNaN(s)?new Date(Date.now()):s,c=l(f);return(m||r)&&(c.locale=m?n:r),c}return u.extendWith=function({name:n,fn:r,isMethod:m=!1,proxifyResult:y=!1}={}){if(!n||!r||!(r instanceof Function))return console.error("es-date-fiddler (extendWith): cannot extend without name and/or fn (function)");a[n]=s=>(s=l(s),s.localeInfo&&s.relocate(s.localeInfo),m?(...f)=>y?l(r(s,...f)):r(s,...f):y?l(r(s)):r(s))},u}export{R as DateXFactory,fe as default};
